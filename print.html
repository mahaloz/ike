<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>&#x27;Ike</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="1_introduction/introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="1_introduction/background.html"><strong aria-hidden="true">1.1.</strong> Background</a></li><li class="chapter-item expanded "><a href="1_introduction/inspiration.html"><strong aria-hidden="true">1.2.</strong> Inspiration</a></li><li class="chapter-item expanded "><a href="1_introduction/overview.html"><strong aria-hidden="true">1.3.</strong> Overview & Schedule</a></li></ol></li><li class="chapter-item expanded "><a href="2_operating_systems/operating_systems.html"><strong aria-hidden="true">2.</strong> Operating Systems</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="2_operating_systems/introduction.html"><strong aria-hidden="true">2.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="2_operating_systems/virtualization.html"><strong aria-hidden="true">2.2.</strong> Virtualization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="2_operating_systems/virtual_machines.html"><strong aria-hidden="true">2.2.1.</strong> Virtual Machines</a></li><li class="chapter-item expanded "><a href="2_operating_systems/containers.html"><strong aria-hidden="true">2.2.2.</strong> Containers</a></li></ol></li><li class="chapter-item expanded "><a href="2_operating_systems/linux_os.html"><strong aria-hidden="true">2.3.</strong> Linux OS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="2_operating_systems/terminal.html"><strong aria-hidden="true">2.3.1.</strong> The Terminal</a></li><li class="chapter-item expanded "><a href="2_operating_systems/permissions.html"><strong aria-hidden="true">2.3.2.</strong> Permissions</a></li><li class="chapter-item expanded "><a href="2_operating_systems/hacker_practice.html"><strong aria-hidden="true">2.3.3.</strong> Hacker Practice</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="3_computer_organization/computer_org.html"><strong aria-hidden="true">3.</strong> Computer Organization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="3_computer_organization/introduction.html"><strong aria-hidden="true">3.1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="3_computer_organization/math_and_counting.html"><strong aria-hidden="true">3.1.1.</strong> Math & Counting</a></li><li class="chapter-item expanded "><a href="3_computer_organization/bits_and_logic.html"><strong aria-hidden="true">3.1.2.</strong> Bits & Logic</a></li></ol></li><li class="chapter-item expanded "><a href="3_computer_organization/memory.html"><strong aria-hidden="true">3.2.</strong> Memory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="3_computer_organization/programs_in_mem.html"><strong aria-hidden="true">3.2.1.</strong> Programs in Memory</a></li><li class="chapter-item expanded "><a href="3_computer_organization/addressing.html"><strong aria-hidden="true">3.2.2.</strong> Addressing</a></li><li class="chapter-item expanded "><a href="3_computer_organization/memory_segments.html"><strong aria-hidden="true">3.2.3.</strong> Memory Segments</a></li></ol></li><li class="chapter-item expanded "><a href="3_computer_organization/assembly.html"><strong aria-hidden="true">3.3.</strong> Assembly</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="3_computer_organization/registers.html"><strong aria-hidden="true">3.3.1.</strong> Registers</a></li><li class="chapter-item expanded "><a href="3_computer_organization/instructions.html"><strong aria-hidden="true">3.3.2.</strong> Instructions</a></li><li class="chapter-item expanded "><a href="3_computer_organization/asm_memory.html"><strong aria-hidden="true">3.3.3.</strong> ASM Memory</a></li><li class="chapter-item expanded "><a href="3_computer_organization/control_structures.html"><strong aria-hidden="true">3.3.4.</strong> Control Structures</a></li><li class="chapter-item expanded "><a href="3_computer_organization/hacker_practice.html"><strong aria-hidden="true">3.3.5.</strong> Hacker Practice</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="4_programming_languages/programming_languages.html"><strong aria-hidden="true">4.</strong> Programming Languages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="4_programming_languages/introduction.html"><strong aria-hidden="true">4.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="4_programming_languages/c.html"><strong aria-hidden="true">4.2.</strong> C</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="4_programming_languages/write_c.html"><strong aria-hidden="true">4.2.1.</strong> Writing Code</a></li><li class="chapter-item expanded "><a href="4_programming_languages/compilation.html"><strong aria-hidden="true">4.2.2.</strong> Compilation & Execution</a></li><li class="chapter-item expanded "><a href="4_programming_languages/debugging_c.html"><strong aria-hidden="true">4.2.3.</strong> Debugging</a></li></ol></li><li class="chapter-item expanded "><a href="4_programming_languages/python.html"><strong aria-hidden="true">4.3.</strong> Python</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="4_programming_languages/write_py.html"><strong aria-hidden="true">4.3.1.</strong> Writing Code</a></li><li class="chapter-item expanded "><a href="4_programming_languages/interp.html"><strong aria-hidden="true">4.3.2.</strong> Interpretation & Execution</a></li><li class="chapter-item expanded "><a href="4_programming_languages/debugging_py.html"><strong aria-hidden="true">4.3.3.</strong> Debugging</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="5_processes/proc_and_debug.html"><strong aria-hidden="true">5.</strong> Processes and Debugging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="5_processes/introduction.html"><strong aria-hidden="true">5.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="5_processes/executable_types.html"><strong aria-hidden="true">5.2.</strong> Executable Types</a></li><li class="chapter-item expanded "><a href="5_processes/gdb.html"><strong aria-hidden="true">5.3.</strong> Using GDB</a></li><li class="chapter-item expanded "><a href="5_processes/interaction.html"><strong aria-hidden="true">5.4.</strong> Interacting with Python</a></li></ol></li><li class="chapter-item expanded "><a href="6_security/security.html"><strong aria-hidden="true">6.</strong> Security Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="6_security/cia.html"><strong aria-hidden="true">6.1.</strong> CIA</a></li><li class="chapter-item expanded "><a href="6_security/enc_and_hash.html"><strong aria-hidden="true">6.2.</strong> Encryption & Hashing</a></li><li class="chapter-item expanded "><a href="6_security/bruteforcing.html"><strong aria-hidden="true">6.3.</strong> Bruteforcing</a></li><li class="chapter-item expanded "><a href="6_security/dos.html"><strong aria-hidden="true">6.4.</strong> DOSing</a></li><li class="chapter-item expanded "><a href="6_security/io.html"><strong aria-hidden="true">6.5.</strong> I/O Vectors</a></li></ol></li><li class="chapter-item expanded "><a href="whats_next.html"><strong aria-hidden="true">7.</strong> What's Next</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">&#x27;Ike</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ike-the-systems-hacking-handbook"><a class="header" href="#ike-the-systems-hacking-handbook">`Ike: The Systems Hacking Handbook</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>Welcome to <code>'Ike</code> (pronounced Eeh-Kay). This handbook is intended to take those with 0 system hacking experience (that's right 0), and get them to an entry-level point within the <a href="https://pwn.college">pwn.college</a> ecosystem. By following these steps, you can establish a strong base upon which to build your future hacking knowledge on. This process will essentially provide you with your white belt in hacking (at a system level), which will only be enhanced within the subsequent pwn.college program. While this handbook leans into the CTF atmosphere commonly seen on sites like <a href="https://ctftime.org/ctf-wtf/">CTFTime</a>, the content should prove insightful to those curious individuals with no CTF experience (if you are looking for web skills, look somewhere else :D). If you
get some usage out of this handbook, I ask you to hmu with a star on the <a href="https://github.com/mahaloz/ike">github repo</a>, so I know people actually use this, lol.</p>
<p>Through this <code>Introduction</code> section, you will find meta-data about the handbook, why it was written,
and what I hope to accomplish with it as well as the target audience. </p>
<h2 id="about"><a class="header" href="#about">About</a></h2>
<p>As <a href="https://zionbasque.com">president</a> of the <a href="http://asuhacking.club">ASU Hacking Club</a>, I have seen a common trend with regards to incoming club recruits. They tend to be driven Freshman or Sophomores who have yet to take the necessary classwork or gain the necessary experience to easily transition into the pwn.college infrastructure. While I currently occupy a leadership position in ASU-HC and Shellphish, I was once in the same position as many of our struggling recruits. Ideally, this perspective should allow me to offer the necessary resources when getting started in ones “hacking” career. I would hope that the following material also helps those occupying an even earlier academic background. If you find any spelling errors or suggestions, feel free to PR me on <a href="https://github.com/mahaloz/ike">github</a>, or just contact me directly on discord: <code>mahaloz#1337</code>. </p>
<h2 id="contributors"><a class="header" href="#contributors">Contributors</a></h2>
<ul>
<li><a href="https://zionbasque.com">Zion Leonahenahe Basque</a>: main author </li>
<li>Scott Weston: editor</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="background"><a class="header" href="#background">Background</a></h1>
<h2 id="the-education-gap"><a class="header" href="#the-education-gap">The Education Gap</a></h2>
<p>Over the course of my ever-evolving CTF career, I've seen various methods for getting started in hacking. There are the classic &quot;getting started&quot; guides (ex. this blog), and then there are the more novel interactive frameworks (ex. pwn.college). Many of my peers tend to lean more towards interactive experiences via CTFs, but there have also been sizable portions on the team that has not. In either case, I think there is a small but impactful knowledge gap when following an official &quot;curriculum&quot; instead of creating one yourself.</p>
<p>To help those cross the aforementioned gap, pwn.college was created. By investing time in pwn.college, one would ideally obtain their &quot;yellow belt&quot; in hacking, with the end result being a set of skills that will help you shape your own future learning curriculum. At this time, the Arizona State University class that uses the pwn.college framework (taught by <a href="https://www.yancomm.net/">Yan</a>) for its curriculum is offered to those with an equivalent CS experience level of a &quot;junior.&quot; In other words, the class expects you to know how to use Linux, understand C,  binary properties ... and much more. If you are already lost, don't despair. I was in the same place as you when I started hacking.  By reading this handbook and investing your time in growing your skillset, you should gain the necessary skills to take this &quot;daunting&quot; junior class.</p>
<h2 id="the-target-audience"><a class="header" href="#the-target-audience">The Target Audience</a></h2>
<p>This handbook is targeted at anyone on or below the &quot;junior in college&quot; level of computer science, though even those individuals may find something useful from this handbook. This handbook is intended to give you all the material and direction you need to start pwn.college. After which, it is assumed you will continue your education with the pwn.college teaching platform. Learning from this handbook will have varying difficulty based on the
reader. The people who will have the most efficient/easiest time learning from this handbook look like this:</p>
<ol>
<li>Comp. Sci. College Juniors</li>
<li>Comp. Sci. College Freshmen/Sophomores</li>
<li>High School Students </li>
</ol>
<p>This of course assumes that you are in a college program that touches on systems (which it should). Things like C, debugging, memory management, operating systems. These things will make this experience much easier,
but this handbook was made to help people who have not yet had the chance to take those types of classes (or don't have access to it). There the individuals who will learn/benefit the most from this is:</p>
<ol>
<li>High School Students</li>
<li>Comp. Sci. College Freshmen/Sophomores</li>
<li>Comp. Sci. College Juniors </li>
</ol>
<p>In the end, many people can benefit from this, so feel free to go to exact sections if you think you have nothing to gain from the others; however, I do encourage everyone to at least skim each section since you may
find some surprising tutorial/article I reference. </p>
<h2 id="the-handbooks-novelty"><a class="header" href="#the-handbooks-novelty">The Handbook's Novelty</a></h2>
<p>As I briefly mentioned <a href="1_introduction/background.html#the-education-gap">above</a>, there exist many places to start practicing pwning and reversing, but not many that will explain the introductory concepts. As an example, taking a look at the <a href="https://guyinatuxedo.github.io/index.html">Nightmare Book's</a> style of teaching. It is layed out into chapters of exploitation techniques, which I like a lot. Each section is a writeup of how to solve a challenge that has the exploitation technique embedded in it. I think this method is extremely effective for learning for those with pre-established skills in Linux, C, and systems. I think this method fails for noobs who are just learning how C really works (on the memory level). In my brain, <em>prepare for what animations look like in my brain</em>, the learning barriers look like this:</p>
<p><strong>Nightmare Method</strong>:</p>
<p><img src="1_introduction/./nightmare-method.png" alt="" /></p>
<p><strong>'Ike Method</strong>:</p>
<p><img src="1_introduction/./ike-method.png" alt="" /></p>
<p>The subtle difference here is that I believe the underlying security concept should be educated and learned about through explicit material first, then it should be reinforced with scripting and systems skills. This is not to say I don't like the Nightmare method, I love it, but others need a different one. This book is that different method. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inspiration"><a class="header" href="#inspiration">Inspiration</a></h1>
<p>While writing this, and coming up with the idea, I took a lot of inspiration from blogs and posts as well
as entire pages dedicated to the education of CTF knowledge. A few stick out in my mind:</p>
<ul>
<li><a href="https://guyinatuxedo.github.io/index.html">Nightmare Book</a>: theme, idea, use of mdbooks</li>
<li><a href="https://ctf-wiki.org/">CTF Wiki</a>: layout, reversing &amp; pwning content</li>
<li><a href="https://pwn.college/">pwn.college</a>: content</li>
<li><a href="https://picoctf.org/">pico.ctf</a>: educating noobs in CTF</li>
</ul>
<p>There are many others that I did not list here, but I will try to link them in as we get through some
of the content that cites them. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="overview--schedule"><a class="header" href="#overview--schedule">Overview &amp; Schedule</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>We will cover as few concepts as possible to make you dangerous enough to start down a systems
hacking journey. I will usually use external tutorials embedded in this one to get ideas, 
skills, or setups done quickly. This handbook acts as duct tape for all those tutorials. </p>
<p>As seen in the table of contents on the left, we go through 5 major topics:</p>
<ul>
<li>Operating Systems
<ul>
<li>ASU Equiv: CSE330,365. Overviews what makes something an operating system, how we can 
virtualize them, and how we use them in hacking. Includes a set up for containers
and VMs.</li>
</ul>
</li>
<li>Programming Languages
<ul>
<li>ASU Equiv: CSE340,240. Overviews what makes something a programming language, then covers
a interpreted and compiled language that are commonly used for hacking. This includes
how to use them efficiently. </li>
</ul>
</li>
<li>Computer Organization 
<ul>
<li>ASU Equiv: CSE230. Overviews the internals of computing and how we organize them, 
including memory layout, assembly (x86), and the types of executable file types
you will find in the wild. </li>
</ul>
</li>
<li>Processes &amp; Debugging
<ul>
<li>ASU Equiv: CSE330,240. Overviews how processes work in Linux and generally. Includes
learning how to trace, debug, and understand running process. Also has a small intro
to using Python to mess with running processes. </li>
</ul>
</li>
<li>Security Concepts
<ul>
<li>ASU Equiv: CSE365. Does a small dive into some common security concepts that will
help new hackers think about problems in different ways. Highly inspired by Adam
Doupe's CSE365.</li>
</ul>
</li>
</ul>
<h2 id="how-use-this-handbook"><a class="header" href="#how-use-this-handbook">How use this handbook</a></h2>
<p>To efficiently use this handbook you should be prepared to follow various links across the web that
I've curated with time. Most links I use are often for things that are more copy-paste-and-follow like.
As an example, in the next section, I'll have you install a Virtual Machine. In that section I use
an external link to have you install it so I don't duplicate work that is already one well. Other things
like using more complex stuff will usually be covered in the handbook. </p>
<p>Another thing to note is the use of the Dinkus within this text:</p>
<pre><code>* * *
</code></pre>
<p>Whenever you see this symbol it means there is link you will need to follow between the text above 
and below it. That link will take more than 15 minutes to complete. As an example, in the next 
section's introduction I place a link to &quot;What is Linux.&quot; I estimate that you will take around
15 minutes or more of time to read that link before progressing onto the next section. Take your
time with the reading, its the absolute minimum you need to read to get that chapters topic. </p>
<p>Lastly, at the end each section, excluding this one, you can find a practice challenge-set that
will test your knowledge on that chapter. It is highly recommended that you complete all the 
challenges the chapter asks for before you move on to the next chapter. Most of our challenges
currently can be found on <a href="https://dojo.pwn.college/challenges">dojo.pwn.college</a></p>
<h2 id="work-in-progress"><a class="header" href="#work-in-progress">Work in Progress</a></h2>
<p>The following sections are still being worked on: </p>
<p>WIP:</p>
<ul>
<li>Programming Languages (50% complete)</li>
<li>Processes &amp; Debugging (25% complete)</li>
<li>Security Concepts (0% complete)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="operating-systems"><a class="header" href="#operating-systems">Operating Systems</a></h1>
<p>A speed introduction to operating systems and the fundamentals needed to be a hacker
when working with Linux. If you are already familar with Linux, skip to the last 
sub-section of this chapter: <a href="2_operating_systems/./hacker_practice.html">hacker practice</a> and do the 
shell practice section. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h1>
<h2 id="background-1"><a class="header" href="#background-1">Background</a></h2>
<p>To start your journey into binary reversing and exploitation, you first need to understand the platform
on which you reverse and exploit. As you are likely aware, you are currently on an operating system (OS):
likely Windows or MacOS. Generally, people know the difference between these OS, but
to be a good hacker you must understand these differences on a technical level. In future modules,
we will talk about MacOS and Windows, but for now Linux will suffice.</p>
<p>What is Linux you may ask? Linux is the operating system of hackers! It is also the OS
that most embedded devices and servers use. Linux is <a href="https://opensource.com/resources/what-open-source">open-source</a>,
which means it is also an OS that is easy to develop on and learn (relative 
to the other ones). Right now it might not be clear what you would be developing that is related
to the OS or how it is useful, but it will hopefully be more clear at the end 
of this section.</p>
<h2 id="linux"><a class="header" href="#linux">Linux</a></h2>
<p>To get a better idea of what Linux is, read the first five sections of this 
<a href="https://www.linux.com/what-is-linux/">article</a>. </p>
<p>* * *</p>
<p>Now that you know what a distribution of Linux is, you can be informed that we will be using the mainstream, 
Debian based distribution <a href="https://ubuntu.com/tutorials">Ubuntu</a>. If you have found your way here 
through external hacking tutorials, you be tempted to use <a href="https://www.kali.org/downloads/">Kali Linux</a>, a
similarly Debian based distribution. I'll make the argument that it will be easier to use Ubuntu than Kali,
and for the basis of these tutorials, the up-to-date kernel of Ubuntu is better.</p>
<p>TL;DR: We will use Ubuntu, almost none of the tools on Kali are needed for this.</p>
<p>In the next sub-section, we get Ubuntu installed.</p>
<h2 id="the-kernel"><a class="header" href="#the-kernel">The Kernel</a></h2>
<p>Before going straight into using an operating system, it's nice to mention that there is a component of
your computer that makes everything run―it's called the <strong>kernel</strong>. In a typical introduction to 
operating systems you would likely be introduced to this idea in-depth, but I will only briefly 
talk about it. If you are very interested, you should read <a href="https://www.amazon.com/Understanding-Linux-Kernel-Third-Daniel/dp/0596005652">this</a> book after completing this handbook,
as the content assumes you are already a systems hacker.</p>
<p>The kernel is the lowest running software that is always running when the computer is on. It's a fundamental
part of the operating system that runs on your computer. If you imagined the computer as a stack of 
software and hardware, the kernel would be the line that divides the two:</p>
<p><img src="2_operating_systems/./computer_stack.jpeg" alt="picture of computer stack" /></p>
<p>The kernel is responsible for:</p>
<ul>
<li>making sure programs have somewhere to run (talked about later)</li>
<li>hardware peripherals, like you physical mouse, actually do things</li>
<li>your computer having enough memory to function </li>
</ul>
<p>And various other tasks that set your computer apart from your toaster oven. It is often true that each 
operating system will have its own kernel that was designed to work with it.</p>
<p>Since this &quot;program&quot; called the kernel is always running and controls everything important, it's safe to 
assume that this program is at a higher level of existence than a normal program. Not only is it at a 
higher level of <strong>privilege</strong> than a normal program, but it is also at a higher level of privilege than
an admin. The kernel is the god of this computing world, none come before it. </p>
<p>Luckily, this god known as the kernel is benevolent and allows measly normal programs to use parts of
it when needed. Let's take my favorite game <a href="https://minecraft.net">minecraft</a> as an example.</p>
<h3 id="minecraft-as-an-example"><a class="header" href="#minecraft-as-an-example">Minecraft as an example</a></h3>
<p>When you use a normal program, like Minecraft, you are running the program in <strong>user space</strong>. The
user space is the virtual space of your computer where normal programs run. As expected, there 
exists a space for kernel things called the <strong>kernel space</strong>.</p>
<p>So you launch Minecraft, and load into your favorite world. You are in the user space. But now,
you move your mouse so that your view in Minecraft rotates -- you have now briefly entered 
kernel space. Why? Because hardware caused something called an <code>interrupt</code>, which in the 
god analogy is equivalent to praying to god for god for a brief blessing of power.</p>
<p>When you move your mouse this is what happens:</p>
<ol>
<li>The software that drives the mouse detects a movement</li>
<li>The software causes an interrupt, which stops whatever else is running for a brief time</li>
<li>It enters kernel mode by setting a value that signifies that it is &quot;privileged&quot;</li>
<li>The kernel interprets the exact movement then sends the info back to user space </li>
<li>The mouse move is handled in Minecraft. </li>
</ol>
<p>You can visualize it like this (prepare for 3rd grade drawings):</p>
<p><img src="2_operating_systems/./minecraft.jpeg" alt="" /></p>
<h3 id="tldr"><a class="header" href="#tldr">TL;DR</a></h3>
<p>The gist here is that there is a <strong>super privileged</strong> software running on every computer called
the kernel. The kernel controls everything at the lowest level, and compromising it means you
compromised everything above it―any software running on the computer. In our next section
on virtualization, it's helpful to know this thing called the kernel exists. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtualization"><a class="header" href="#virtualization">Virtualization</a></h1>
<p>Virtualization is the cornerstone of modern operating systems. To virtualize something is 
to create a virtual version of it that does not require hardware. As an example, it's like
running an Android phone on your laptop. The android operating system is supposed to only
be run on phone hardware (for the most part), but yet we can run it on a laptop with 
an <a href="https://developer.android.com/studio/run/emulator">emulator</a>. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="virtual-machines"><a class="header" href="#virtual-machines">Virtual Machines</a></h1>
<h2 id="what-is-a-virtual-machine"><a class="header" href="#what-is-a-virtual-machine">What is a Virtual Machine?</a></h2>
<p>A virtual machine (VM) is a virtualized operating system. Read this 
<a href="https://www.redhat.com/en/topics/virtualization/what-is-a-virtual-machine">article</a> before
continuing. If you are very lazy, you can just watch this <a href="https://www.youtube.com/watch?v=yIVXjl4SwVo">video</a></p>
<p>* * *</p>
<p>We use VMs, as said in the article, because it is isolated from the host system and 
it allows us to keep our nice comfortable OS on our computer. This means you will
have both your host OS (Windows/MacOS), and this VM of Linux for hacking.</p>
<h2 id="setting-up-a-vm"><a class="header" href="#setting-up-a-vm">Setting up a VM</a></h2>
<p>If you are an ASU student, use VMWare. The school has given access
to it for free. Get it <a href="https://ets.engineering.asu.edu/vmware/">here</a>.
If you are not, <a href="https://www.virtualbox.org/wiki/Downloads">Virtualbox</a> works as well.</p>
<p>* * *</p>
<p>Now that you have download the software to use a VM, let's actually make an Ubuntu VM.
Follow the tutorial below for the software you are using:</p>
<ul>
<li><a href="https://linuxhint.com/install_ubuntu_vmware_workstation/">VMWare Tutorial</a></li>
<li><a href="https://itsfoss.com/install-linux-in-virtualbox/">Virtual Box Tutorial</a></li>
</ul>
<p>After following the tutorials above, you should have an Ubuntu machine ready to go with a
login.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="containers"><a class="header" href="#containers">Containers</a></h1>
<p>Containers are another level of virtualization that allows for isolated spaces in the kernel
to be created and destroyed without affecting each other. </p>
<h2 id="what-is-a-container"><a class="header" href="#what-is-a-container">What is a container?</a></h2>
<p>To get more specific, read what Docker has to say on what a Container is: <a href="https://www.docker.com/resources/what-container">here</a>.
Now you may be wondering, how does this differ from a VM? As an end-user, there is no difference. But as 
far as technicals go, Microsoft's diagram is a good comparison:</p>
<p><strong>VMs vs Containers</strong>
<img src="2_operating_systems/./ms_container_v_vm.png" alt="" /></p>
<p>In simple terms, a VM is much more heavy since we need to initialize an entirely new kernel for each VM we make.
In a container, we share the already existent kernel and, using some technical tricks, create isolated sections
of the kernel that we then use to create containers (which act as VMs). </p>
<p><strong>TL;DR</strong>: container light, VM heavy.</p>
<h3 id="why-use-a-container"><a class="header" href="#why-use-a-container">Why use a container?</a></h3>
<p>You may be asking yourself, &quot;why use a container?&quot; We already are in a VM, so as far as affecting our host machine goes, we are
already in the clear. Containers become the most useful when trying to run applications that have dependencies that
we might not have access to in our current version of the VM. For instance, wanting to run an <code>Ubuntu 18.04</code> application
while in <code>Ubuntu 20.04</code>. You can either pray to the computer gods and hope your dependences still work in the new version,
or you can use a docker container that creates an <code>Ubuntu 18.04</code> environment in it to run. The latter is easier. In addition,
containers are not persistent, meaning that when you are done running the container, everything you created inside of it is
destroyed. </p>
<h2 id="docker-the-modern-container"><a class="header" href="#docker-the-modern-container">Docker: the modern container</a></h2>
<p>Now that you know what a container is, it's time we set you up to be able to use containers. There are many implementations
of containers, but the one we will use is <a href="https://www.docker.com/why-docker">Docker</a>. Docker is very mainstream and 
has a lot of use across the computer science industry. Take for instance <a href="https://wordpress.com/">Wordpress</a>, which you
have likely heard of or used. It's a platform for building websites for free with a GUI. It also has a lot of 
dependencies and things you need to set up before using it. Wordpress uses Docker, and has made a docker container
that does it all for you. Check it out: <a href="https://hub.docker.com/_/wordpress">here</a>. Essentially you can run an entire
wordpress hosting software with a database all with this simple command in a terminal:</p>
<pre><code class="language-docker">docker run wordpress
</code></pre>
<p>Which is a great segway into installing Docker, since it requires use of the <code>command line</code>.</p>
<h2 id="setting-up-docker"><a class="header" href="#setting-up-docker">Setting up docker</a></h2>
<p>We will now install <code>Docker</code> on your <code>Ubuntu VM</code>, so from now on all instructions are pertaining to being inside
you VM. First login to the VM, then open up the terminal. You can do this by either searching applications or 
simple right-clicking the desktop and clicking <code>&quot;Open terminal&quot;</code>. This is where the fun begins. Pro-tip,
you can click the copy button in the top left of the code snippets to copy and paste to your terminal.</p>
<p>It's alright if you don't understand all the commands in this section, we will cover using the terminal later.</p>
<p>First, we need to update the list of installable applications. Run:</p>
<pre><code class="language-bash">sudo apt-get update
</code></pre>
<p>After that, we need to install the dependencies of docker:</p>
<pre><code class="language-bash">sudo apt-get install \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
</code></pre>
<p>Next, let's add dockers GPG key so we can get their software:</p>
<pre><code class="language-bash">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre>
<p>Add the repository:</p>
<pre><code class="language-bash">sudo add-apt-repository \
   &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable&quot;
</code></pre>
<p>Finally, update once more and install:</p>
<pre><code class="language-bash">sudo apt-get update
</code></pre>
<pre><code class="language-bash">sudo apt-get install docker-ce docker-ce-cli containerd.io
</code></pre>
<p>Congratulations, you just installed your first command line tool! And quite a powerful one.
Let's verify it works.</p>
<h2 id="using-docker"><a class="header" href="#using-docker">Using docker</a></h2>
<h3 id="verification"><a class="header" href="#verification">Verification</a></h3>
<p>To verify you actualy have docker running, simply run:</p>
<pre><code class="language-bash">sudo docker run hello-world
</code></pre>
<p>The output should look something like:</p>
<pre><code>Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre>
<h3 id="having-some-fun"><a class="header" href="#having-some-fun">Having some fun</a></h3>
<p>To make things a little more interesting, let's launch an older Ubuntu version <strong>inside</strong> your
current Ubuntu version. Virtualception. Let's first see what version we are on in our machine:</p>
<pre><code class="language-bash">grep '^VERSION' /etc/os-release
</code></pre>
<p>I'm on <code>Ubuntu 18.04</code>, so my command output this:</p>
<pre><code class="language-bash">VERSION=&quot;18.04.5 LTS (Bionic Beaver)&quot;
VERSION_ID=&quot;18.04&quot;
VERSION_CODENAME=bionic
</code></pre>
<p>You may be on <code>20.04</code> so it will look slightly different. Take a note of the version you are on. </p>
<p>Now let's start an <code>Ubuntu 16.04</code> machine. Run:</p>
<pre><code class="language-bash">docker run -it ubuntu:16.04
</code></pre>
<p>Since it's the first run it will take a few minutes for it to pull down the Ubuntu image data. 
Once it's done, you should see a waiting prompt that looks like:</p>
<pre><code class="language-bash">root@cadd99990677:/#
</code></pre>
<p>You have now opened a terminal in a virtual Ubuntu. Congratz. Run the same command from earlier in this prompt:</p>
<pre><code class="language-bash">grep '^VERSION' /etc/os-release
</code></pre>
<p>The output should be:</p>
<pre><code class="language-bash">VERSION=&quot;16.04.7 LTS (Xenial Xerus)&quot;
VERSION_ID=&quot;16.04&quot;
VERSION_CODENAME=xenial
</code></pre>
<p>Pretty cool right? We are inside a virtual machine in a virtual machine (technically a container, but you get the point).
Now type:</p>
<pre><code class="language-bash">exit
</code></pre>
<p>and hit enter. You will be back to your normal terminal. Amazing! </p>
<p>We will use Docker often. If you are excited about this, you can check out this tutorial: <a href="https://docs.docker.com/get-started/02_our_app/">here</a>,
though it is not mandatory. Now it's time to learn how to use <code>Bash</code>, the terminal you typed on earlier. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-os"><a class="header" href="#linux-os">Linux OS</a></h1>
<p>Instead of explaining how the Linux Operating System works from the ground up, we will
instead attempt to learn how to use it as quickly as possible. To do this, we will cover:</p>
<ul>
<li>Using the terminal</li>
<li>Permissions and how they work</li>
<li>SSHing</li>
<li>Puzzle solving in the shell</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-terminal"><a class="header" href="#the-terminal">The Terminal</a></h1>
<p>You got a little taste of using the terminal in the last section, but now it's time we
got literate. Expect this section to take a few hours since we will be out-sourcing
work to a few different problems/tutorials across the web. </p>
<p>For the majority of getting you good with begging parts of Linux, we will be using
the amazing class <a href="https://missing.csail.mit.edu/">The Missing Semester</a> by MIT. 
We will not be doing the entire class, only the parts that matter the most.</p>
<h2 id="the-shell"><a class="header" href="#the-shell">The Shell</a></h2>
<p>You can think of the shell as the terminal you used earlier. The shell is your
text interface into the computer. It allows you to do things quickly and powerfully.
To become a good hacker, you must first learn how to navigate and use a shell. </p>
<p>To do this, we will now jump to the earlier mentioned MIT course on hacking
tools. Read <strong>and do the exercises</strong> of this lesson: <a href="https://missing.csail.mit.edu/2020/course-shell/#topic-1-the-shell">Topic 1: The Shell</a>.
If you do not like reading, you can also find the lecture at the top of that page. 
This will take some time, so come back here when you are done. </p>
<p><em>take the time to do the exercises before moving on, it will help</em></p>
<h2 id="shell-scripting"><a class="header" href="#shell-scripting">Shell Scripting</a></h2>
<p>At this point, it should start becoming clearer that each shell has it's own
scripting language that makes automation very easy. Hacking often involves
repetitive tasks and doing things on a massive level from a shell. Let's
learn how to use <em>scripting</em> (using the language) in a powerful way.</p>
<p>Like last time, Read <strong>and do the exercises</strong> of this lesson: <a href="https://missing.csail.mit.edu/2020/shell-tools/">Topic 2: Shell Tools</a>
This will take some time, so come back here when you are done. </p>
<h2 id="using-vim"><a class="header" href="#using-vim">Using VIM</a></h2>
<p>Often, after scripting and finding your way to files in your filesystem you
need to edit them. Currently, you should have no idea how to edit files in your terminal, but we
are going to change that now. Hackers need to work fast, and that means writing code directly
from the same interface you use to run it. The terminal is this place. To edit things
fast, we use a quaint program called <a href="https://www.vim.org/">VIM</a> -- it looks old and feels old,
but it is very powerful. </p>
<p>Like earlier, Read <strong>and do the exercises</strong> of this lesson: <a href="https://missing.csail.mit.edu/2020/editors/">Topic 3: Editors</a>
This will take some time, so come back here when you are done. </p>
<p>After this, you will be quite a powerful user. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="permissions"><a class="header" href="#permissions">Permissions</a></h1>
<p>The permission to do something is a major component of hacking. Often, we are trying to escelate
our privligae in whatever scenario that is. This can mean becoming the admin of a computer you don't own, 
or simply being able to access restricted things in a video game. Following in this nature, files
in the Linux operating system have permissions.</p>
<p>To learn how they work, read <a href="https://linuxcommand.org/lc3_lts0090.php">this</a>. It should be easier 
and faster than the earlier sections, considering you may have already encountered permissions in
your own system. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hacker-practice"><a class="header" href="#hacker-practice">Hacker Practice</a></h1>
<p>To practice, we are going to be using a hacking practice site called a Wargame site. These sites
are similar to a CTF in that they offer challenging puzzles that require technical knowledge. 
They are different in the fact that they have no time limit to the competition. People from across
the world can use the challenges on the site at any time.</p>
<p>The site we are using is called Over The Wire. </p>
<p>The wargame Over The Wire has a lot of different modules that you can practice on, but for the sake
of speed in getting up to hacking whitebelt in a reasonable time, we will only be doing the
<a href="https://overthewire.org/wargames/bandit/">bandit</a> challenges. Before you start, let's talk about how you will play them.
If you already know how to use SSH, skip to the <a href="2_operating_systems/hacker_practice.html#practice">practice</a>.</p>
<h2 id="ssh"><a class="header" href="#ssh">SSH</a></h2>
<p><a href="https://en.wikipedia.org/wiki/SSH_(Secure_Shell)">SSH</a> stands for Secure Shell. It's a protocol 
(messaging language) used to get a remote shell on another machine. A remote shell is what it sounds 
like: an interactive shell you can use on a machine you don't have physical access too. After using it a 
few times it becomes clearer what this means. </p>
<p>Recall the Ubuntu container we used in the <a href="2_operating_systems/./containers.html">containers</a> section. We ran our 
docker command and it gave us a shell into a different Ubuntu version.</p>
<pre><code class="language-bash">docker run -it ubuntu:16.04
</code></pre>
<p>It resulted in a shell. And to get out of the shell, and subsequently the container, we used:</p>
<pre><code class="language-bash">exit
</code></pre>
<p>In the shell we had, which returned us to our machine. SSHing is very similar. Let's SSH into
the first level of bandit, which is <a href="https://overthewire.org/wargames/bandit/bandit0.html">here</a>.</p>
<pre><code class="language-bash">ssh bandit0@bandit.labs.overthewire.org -p 2220
</code></pre>
<p>Input the password, <code>bandit0</code>, and now we are in a shell: </p>
<pre><code class="language-bash">bandit0@bandit:~$
</code></pre>
<p>As you guessed it, this is likely a different version of Ubuntu then what you are running. Use our 
earlier command from the containers section to check what that is. To confirm that this is<br />
a machine we don't own, let's check what the ip address is. An ip address is an address that is 
associated with a device on the internet. Ideally, this is a unique address that no other device
should share, but nowadays this is not always true. For now, assume it is unique. </p>
<p>Run:</p>
<pre><code class="language-bash">curl https://ipinfo.io/ip
</code></pre>
<p>Take a note of the address, then <code>exit</code> the machine just like before:</p>
<pre><code class="language-bash">exit
</code></pre>
<p>Now we are back on our host machine. Run the same <code>curl</code> command again to get the ip address of 
your machine:</p>
<pre><code class="language-bash">curl https://ipinfo.io/ip
</code></pre>
<p>Notice the numbers are fairly different? This confirms that the machine is at least not local 
(on our current network). If you want to take it further, you can even look up the location 
associated with the ip address of <code>Over The Wire</code>. </p>
<h3 id="ssh-semantics"><a class="header" href="#ssh-semantics">SSH Semantics</a></h3>
<p>Lastly, let's talk about the semantics of the actual <code>SSH</code> command we ran:</p>
<pre><code class="language-bash">ssh bandit0@bandit.labs.overthewire.org -p 2220
</code></pre>
<p>Like logging into any machine, it requires a username. The first part of the ssh command is
the username, which is <code>bandit</code> in this case. Next is the <code>@</code> symbol to signify where the end
of the username is and where the remote address begins. The address here is
<code>bandit.labs.overthewire.org</code>. You may be confused here because it does not look like a normal
ip address, which is just numbers. This is due to <a href="https://www.cloudflare.com/learning/dns/what-is-dns/">DNS</a>.
DNS is outside the scope of this section, but just know it allows you to have fancy names point 
to normal looking ip addresses. </p>
<p>So far we have learned SSH looks like:</p>
<pre><code class="language-bash">ssh &lt;username&gt;@&lt;ip_address&gt;
</code></pre>
<p>The last thing we have to talk about is the <code>-p 2220</code> in the command. This is an option that specifies 
a <a href="https://en.wikipedia.org/wiki/Port_(computer_networking)">port</a> to connect over. You can learn more 
about all the options of <code>ssh</code> by running:</p>
<pre><code class="language-bash">man ssh
</code></pre>
<h2 id="practice"><a class="header" href="#practice">Practice</a></h2>
<p>Now that you have this last tool, SSH, in your arsenel, you are ready to start some hacking practice.
To show you are truely ready to progress to the next section, you must prove you are competent 
with the shell. </p>
<p>On <a href="https://overthewire.org/wargames/bandit/">OverTheWire: Bandit</a> do levels <a href="https://overthewire.org/wargames/bandit/bandit0.html">0</a>
through <a href="https://overthewire.org/wargames/bandit/bandit15.html">15</a>. These levels should take you a day or two
to complete depending on how fast you get the later levels done. Good luck, and when you complete this
head over to the next section! </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="computer-organization"><a class="header" href="#computer-organization">Computer Organization</a></h1>
<p>In the last chapter, you learned how to use other people's programs (<code>ls</code>, <code>sh</code>, <code>find</code>), virtualize things, and how the operating system
interacts with programs. In this chapter, we learn how to write our own programs, interface directly with the kernel, and understand how the computer manages high-level ideas for our low-level solutions. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h1>
<p>To cover computer organization is to cover what it means to <em>be a computer</em>. The way we organize the hardware dictates how our computer works. The organization of hardware in a particular form is called a <a href="https://en.wikipedia.org/wiki/Computer_architecture">computer architecture</a>.</p>
<h2 id="the-von-neumann-architecture"><a class="header" href="#the-von-neumann-architecture">The Von Neumann Architecture</a></h2>
<p>The von Neumann architecture is by far the most famous and well-known abstract computer architecture in computer science. Its principal belief is that our computer is a &quot;pyramid&quot; of memory units that get faster but smaller as we go up the stack. You put things you need faster in the higher level memories, and things you need slower and in larger quantities in the lower level memories: </p>
<p><img src="3_computer_organization/./mem_model_1.jpeg" alt="" /></p>
<p>Abstractly, this is done because faster memory units are more expensive to make, and usually, we don't need faster memory for long. So what the hell is a faster memory unit? Let's revise the picture above:</p>
<p><img src="3_computer_organization/./mem_model_2.jpeg" alt="" /></p>
<p>Two commonly known memory units are your hard drive and your RAM. As you likely know, the RAM is much smaller than your hard drive, but somehow much more expensive. In a parallel fashion, your RAM is also much faster than your hard drive. From now on, let's refer to your RAM as <a href="https://www.computerhope.com/jargon/m/memory.htm">computer memory</a>. You probably have 8 Gigabytes of memory. Why is it so small? What is your computer memory actually used for? Why does it exist aside from your hard drive? The Von Neumann architecture dictates that it exists to put things we need more frequently or faster in. The special thing about your computer memory, though, is that it is volatile—meaning anything put in it is deleted when your computer restarts. </p>
<p>Often the things we need in memory are programs, because we want those to run as fast as possible. Before we talk about putting programs in memory, we need to briefly talk about how we count in computers (yes, strange idea). Move on to the next reading.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="math--counting"><a class="header" href="#math--counting">Math &amp; Counting</a></h1>
<h2 id="bits"><a class="header" href="#bits">Bits</a></h2>
<p>You've seen it before in movies, a series of ones and zeros. Now you have a name to go with it: Bits! Here is an example of some Bits:</p>
<pre><code class="language-python">0100010101001001011101001001001000000000011101101111010111010110
</code></pre>
<p>According to <a href="https://en.wikipedia.org/wiki/Bit">Wikipedia</a>:</p>
<blockquote>
<p>&quot;The bit is a basic unit of information in computing and digital communications ... The bit represents a logical state with one of two possible values. These values are most commonly represented as either &quot;1&quot; or &quot;0&quot;, but other representations such as true/false, yes/no, +/−, or on/off are common.&quot;</p>
</blockquote>
<p>Let's take emphasis to the &quot;represents a logical state with one of two possible values.&quot; So a bit <code>b</code>, can be either a <code>1</code> or a <code>0</code>. That means a single bit has two combinations (1 or 0). Let's make this a little more abstract: a single bit can represent two distinct things.</p>
<p>As an example, let's say we own a light tower at a dock. If the light is on, aka <code>1</code>, then a boat can dock now. If the light is off, aka <code>0</code>, then the boat can't dock now. Simple, on or off. <code>1 = dock</code>; <code>0 = no dock</code>. But what if we need to tell the people in the boats more than just two things? Well, we can get more lights (aka more bits). If we have two bits, we now have <code>2 * 2 = 4</code> possible combinations, so we can represent 4 things in total now.</p>
<p>Assume the boaters know which light is on the left and which is on the right. Now we can signal four different states of docking:</p>
<pre><code>00 = can't dock now
01 = can dock in 1 hour
10 = can dock in 2 hours
11 = can dock now 
</code></pre>
<p>So if the left light is on, but the right is not, then you can dock in 2 hours. In this way, we just <a href="https://techterms.com/definition/encoding">encoded</a> 4 different states of being. Pretty cool right? How in only two series of 1's and 0's we got that much information out. So how does it scale? </p>
<h3 id="scaling-bits"><a class="header" href="#scaling-bits">Scaling Bits</a></h3>
<p>If 1 bit can encode <code>2 data states</code>. 2 bits can encode <code>4 data states</code>. 3 bits can encode <code>2 * 2 * 2 = 8 data states</code>. The pattern here is called the power of twos. To get the number of states your bits can represent is simple: raise 2 to the power of the number of states you have. Here is a fancy function for it:</p>
<pre><code>states(b) = 2 ^ b
</code></pre>
<p>Where <code>b</code> is the number of bits you have. So if you have <code>8 bits</code>, then you have <code>2 ^ 8 = 256</code> different states you can represent... Yeah, that scales very fast. If you just had 8 flash lights, you could represent 256 different things to your friend across the street. Pretty cool. You may have noticed already, but its an exponential ramp-up on the number of states you can represent, which is good for us computer scientist.</p>
<h2 id="bits--bytes"><a class="header" href="#bits--bytes">Bits &amp; Bytes</a></h2>
<p>Often, we need to use more than just a single bit. We call a set of 8 bits a <strong>byte</strong>. Using our earlier maths, a single byte can represent 256 different states. When we use bits to store human data, we usually need much more than 1 byte. This is where our SI table comes for bytes:</p>
<pre><code>1 kilobyte (kb) = 1024 bytes = 8192 bits
1 megabyte (mb) = 1024 kb 
1 gigabyte (gb) = 1024 mb
1 terabyte (tb) = 1024 gb
</code></pre>
<p>You probably have more or equal to 256 GB of disk storage right? That means your disk has <code>2147483648</code> bits ready to hold either a <code>1</code> or <code>0</code> in it's place. That also means that your hard disk can represent <code>2 ^ 2147483648</code> different states. That's insane. How they do that with hardware is out of the scope of this handbook, but know that they do it with a little electrical engineering magic.</p>
<h2 id="hexadecimal"><a class="header" href="#hexadecimal">Hexadecimal</a></h2>
<p>We talk about bytes so much that it is often easier to refer to a binary number in a completely new counting system called <a href="https://simple.wikipedia.org/wiki/Hexadecimal">hexadecimal</a> because it is more concise. Hexadecimal is one type of number system. Decimal, the one we usually count in, is another. To understand these <code>bases</code> and how to look at hex, watch this <a href="https://www.youtube.com/watch?v=4EJay-6Bioo">khan academy video</a></p>
<p>...</p>
<p>As a recap, Hex is converted to decimal and binary like so:</p>
<pre><code>0 = 0 (10) = 0000
1 = 1 (10) = 0001
2 = 2 (10) = 0010
3 = 3 (10) = 0011
4 = 4 (10) = 0100
5 = 5 (10) = 0101
6 = 6 (10) = 0110
7 = 7 (10) = 0111
8 = 8 (10) = 1000
9 = 9 (10) = 1001
A = 10 (10) = 1010
B = 11 (10) = 1001
C = 12 (10) = 1100
D = 13 (10) = 1101
E = 14 (10) = 1110
F = 15 (10) = 1111
</code></pre>
<p>To make it clear that we are writing in hex, and not decimal, we will always append a <code>0x</code> to the beginning of the number. So when we say <code>0x0F</code>, you know we mean <code>15</code> in decimal. </p>
<p>To tie this all together, we go back to how many bits are in a byte. There are 8 bits in a byte which we usually write like so <code>0000 0000</code>. We write it like that because the hex representation is <code>0x00</code>. Now we can refer to bigger bit numbers really easy. For instance, if we wanted to refer to <code>20</code> decimal we would just write <code>0x14</code>, which is <code>0001 0100</code> in binary. If you were confused about that conversion, re-watch the video above. </p>
<p>Remember that hex bytes can also scale just like we did earlier with bits. We can represent <strong>huge</strong> numbers with hex that we would not normally talk about, like:</p>
<pre><code class="language-python">0x7ffff7dd409
</code></pre>
<p>Which represents the number <code>140737351860368</code> in decimal. Yup that value took 6 bytes to represent. Aka <code>6*8</code> bits.</p>
<p>Now that we understand the fundamentals of bits, lets move on to using them in logic.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bits--logic"><a class="header" href="#bits--logic">Bits &amp; Logic</a></h1>
<p>Continuing our discussion on bits, let's talk more about how we can mess with the states system we described earlier. Before that, lets clarify some notation:</p>
<h2 id="logic"><a class="header" href="#logic">Logic</a></h2>
<p>You've definitely heard the term often, but how deeply have you understood the fundamentals of it? You can find an elongated definition on Wikipedia for <a href="https://en.wikipedia.org/wiki/Mathematical_logic">Mathematical Logic</a>, but lets define it simply as conclusions and reasoning of truths.</p>
<hr />
<h3 id="notation"><a class="header" href="#notation">Notation</a></h3>
<ul>
<li><code> x = y</code> means y is assigned to x, or, x is now what y is.</li>
<li><code>x == y</code> is a statement about equivalence &quot;x is the same as y&quot;.</li>
</ul>
<p>The second thing is a question of whether x is the same as y or not. As an example, say <code>x = 7; y = 3</code>. If we now say:</p>
<pre><code>x == y
</code></pre>
<p>The answer to the question would be <code>False</code>. We could also write it as:</p>
<pre><code>(x == y) -&gt; False
</code></pre>
<p>This could also be said as <code>x == y</code> implies <code>False</code>. </p>
<hr />
<p>To make logic easy to write in concise ways, we define abstract things as variables. Something like:</p>
<ul>
<li>S: &quot;Today it's sunny&quot;</li>
<li>R: &quot;Toady it's rainy&quot;</li>
</ul>
<p>Now just having truths assigned to variables would make logic very useless, so they only become useful when we apply <strong>operations</strong> to them. These operations are called <strong>logic operations</strong>. There are 4 fundamental logic operators:</p>
<ul>
<li>AND</li>
<li>OR</li>
<li>NOT</li>
<li>XOR</li>
</ul>
<p>Let't talk about each one.</p>
<h3 id="and"><a class="header" href="#and">AND</a></h3>
<p><code>AND</code> works logically like how you use it in english. Its useful for understanding the truth of two things. As an example:</p>
<pre><code>S: &quot;Today it's sunny&quot;
R: &quot;Today it's rainy&quot;

S = True
R = False

(S AND R) -&gt; False
</code></pre>
<p>Let's decode the above. First, we defined S and R as shorthand notation for an abstract thing like the state of the day (being rainy or sunny). Next we described the truth of the states we defined. &quot;Today it's sunny&quot; is True; then we said &quot;Today it's rainy&quot; is False. Lastly, we evaluated the truth value of:</p>
<p><code>(S AND R)</code></p>
<p>or the statement:</p>
<p><code>Today it is sunny AND it is rainy</code>, which is <code>False</code>.</p>
<p>It's False because we had earlier said that it was not rainy today. In this way, you can treat <code>AND</code> like a function that takes two arguments <code>AND(x, y)</code>. The input is two truth variables (which could be true or false), and the output is <code>True</code> or <code>False</code>. Let's shorten the state <code>True</code> to T and <code>False</code> to F. With all your knowledge we can easily define all the possible outputs of <code>AND</code>, known as a <a href="https://en.wikipedia.org/wiki/Truth_table">truth table</a>.</p>
<div class="table-wrapper"><table><thead><tr><th>X</th><th>Y</th><th>X AND Y</th></tr></thead><tbody>
<tr><td>F</td><td>F</td><td>F</td></tr>
<tr><td>T</td><td>F</td><td>F</td></tr>
<tr><td>T</td><td>T</td><td>T</td></tr>
<tr><td>F</td><td>T</td><td>F</td></tr>
</tbody></table>
</div>
<p>As you can see, the output is only ever True if both X and Y are true. After all of this, it will be much easier to define the other operators.</p>
<h3 id="or"><a class="header" href="#or">OR</a></h3>
<p><code>OR</code> is very similar to <code>AND</code>. It takes two truth values and outputs <code>True</code> if just one of the two are <code>True</code>. Here is the truth table:</p>
<div class="table-wrapper"><table><thead><tr><th>X</th><th>Y</th><th>X OR Y</th></tr></thead><tbody>
<tr><td>F</td><td>F</td><td>F</td></tr>
<tr><td>T</td><td>F</td><td>T</td></tr>
<tr><td>T</td><td>T</td><td>T</td></tr>
<tr><td>F</td><td>T</td><td>T</td></tr>
</tbody></table>
</div>
<h3 id="not"><a class="header" href="#not">NOT</a></h3>
<p><code>NOT</code> is special because it only takes a single truth value. All <code>NOT</code> does is reverse the truth of its argument. Here is the truth value:</p>
<div class="table-wrapper"><table><thead><tr><th>X</th><th>NOT X</th></tr></thead><tbody>
<tr><td>F</td><td>T</td></tr>
<tr><td>T</td><td>F</td></tr>
</tbody></table>
</div>
<p>Its useful now though to say that you can compound logical operators:</p>
<div class="table-wrapper"><table><thead><tr><th>X</th><th>Y</th><th>X OR Y</th><th>NOT( X OR Y )</th></tr></thead><tbody>
<tr><td>F</td><td>F</td><td>F</td><td>T</td></tr>
<tr><td>T</td><td>F</td><td>T</td><td>F</td></tr>
<tr><td>T</td><td>T</td><td>T</td><td>F</td></tr>
<tr><td>F</td><td>T</td><td>T</td><td>F</td></tr>
</tbody></table>
</div>
<p>In addition to that, NOT also has a special reversing mechanic on <code>AND</code> and <code>OR</code>. For instance:</p>
<pre><code>(NOT(X OR Y)) == (NOT(X) AND NOT(Y))
</code></pre>
<p>You can test that above by making your own truth table. Notice how you can distribute the <code>NOT</code> to each variable and the operator, which flipped it to <code>AND</code>. The same is true in the reverse. </p>
<h3 id="xor"><a class="header" href="#xor">XOR</a></h3>
<p><code>XOR</code> takes two truth values like the others, but is less used in normal english. Its short for <code>Exclusive</code>, which means the output is only true when the inputs differ:</p>
<div class="table-wrapper"><table><thead><tr><th>X</th><th>Y</th><th>X XOR Y</th></tr></thead><tbody>
<tr><td>F</td><td>F</td><td>F</td></tr>
<tr><td>T</td><td>F</td><td>T</td></tr>
<tr><td>T</td><td>T</td><td>F</td></tr>
<tr><td>F</td><td>T</td><td>T</td></tr>
</tbody></table>
</div>
<p>Notice how it is only True when things going in are different from each other? Its an interesting mechanic and will be used more later. </p>
<p>Now that we have a high level understand of logic, we can now relate it </p>
<h2 id="bit-logic"><a class="header" href="#bit-logic">Bit Logic</a></h2>
<p>Logic with bits work exactly the same as logic in general. <code>True</code> is <code>1</code>; <code>False</code> is <code>0</code>. </p>
<h3 id="notation-1"><a class="header" href="#notation-1">Notation</a></h3>
<p>Here is our new notation that is generally for bit logic:</p>
<pre><code>AND: &amp;
OR: |
NOT: !
XOR: ^
</code></pre>
<p>All of them still work the same, but now if I want to say <code>x AND y</code> I would actually say <code>x &amp; y</code>.</p>
<h3 id="multi-bit-logic-operations"><a class="header" href="#multi-bit-logic-operations">Multi-Bit Logic Operations</a></h3>
<p>Operations on variables with bits work even on the <strong>byte</strong> level:</p>
<pre><code>x = 11110101    
y = 00101101

(x &amp; y) == 00100101
</code></pre>
<p>How did the above work? If you look closely, each logic operation was applied on each individual bit it lined up with. </p>
<p>Now, recall that bits can also be represented as hex! This means we can do logic operations on things that <em>look</em> like numbers (but remember they are bits under the hood):</p>
<pre><code>x = 0x13 (00010011) 
y = 0x32 (00110010)

(x &amp; y) == 0x33 (00110011)
</code></pre>
<p>This entire time we have been using <strong>bytes</strong>, but to keep with the earlier theme, why don't we assume that we can represent things in 64bits. For conciseness, we don't write leading 0's in a hex number:</p>
<pre><code>x = 0xcafe (64 bits)
y = 0xbabe (64 bits)

(x ^ y) == 0x0000000000007040
</code></pre>
<p>The zeros are shown in the result just to clarify once again that we are in 64bits, but all the operations we have done before still work. Remember you can always compound logic statements on other logic statements (and store them in another variable if you).</p>
<h3 id="logic-gates"><a class="header" href="#logic-gates">Logic Gates</a></h3>
<p>All these bit operations are actually mechanics of real-world hardware that things run on. Since electricity is like a 1 or a 0, it makes sense that these logic gates are what we first implemented in hardware.</p>
<p>Circuit Engineers annotate these gates like shown <a href="https://en.wikipedia.org/wiki/Logic_gate#Symbols">here</a>. Generally speaking, all things on computers first start with these fundamental logic gates that are implemented in hardware. </p>
<p>Now that we understand how to truly utilize the power of bits and logic, we can move on to understand a computer at its lowest level. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="memory"><a class="header" href="#memory">Memory</a></h1>
<p>Returning back from our discussion on <a href="3_computer_organization/./math_and_counting.html">counting</a>, let's talk about RAM, which we now refer to as computer memory. We will first talk about how the Von Neumann architecture affects how we run programs; then, we will talk about how bits dictate just how large programs can be. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="programs-in-memory"><a class="header" href="#programs-in-memory">Programs in Memory</a></h1>
<h2 id="things-exist-in-memory"><a class="header" href="#things-exist-in-memory">Things Exist in Memory</a></h2>
<p>Recall our earlier discussion on the Von Neumann architecture. We want things that we need faster to be used in the RAM since it is faster than the disk. </p>
<p>The things we usually need faster than anything else are our running <strong>programs</strong>. In addition, we don't need the space taken up by the running program to exist for a <em>long time</em>. Once we close our program, we want the running code that runs that program to be destroyed. To clarify, we don't want the data that the program creates destroyed, but the actual code that runs the program for that instance of it running. That's a lot of circular logic. Let's explain it out for our favorite game Minecraft.</p>
<h3 id="minecraft-as-something-living-in-memory"><a class="header" href="#minecraft-as-something-living-in-memory">Minecraft as something living in Memory</a></h3>
<p>Let's say you wanted to start up Minecraft, open your favorite world you have been working on for three months, and place a single block from your inventory, then save and quit. Here's what happens:</p>
<ol>
<li>You double click the Minecraft icon</li>
<li>Immediately, the OS places a copy of Minecraft's Code into RAM</li>
<li>The OS (CPU) starts <strong>executing</strong> the location of memory Minecraft specified to start with</li>
</ol>
<p>Now Minecraft is running and you can interact with it. When you click buttons in the Minecraft game, it simply transitions to different locations in memory where those button's code exists. Now you open your world:</p>
<ol>
<li>You click &quot;open world&quot; and you select your awesome world. </li>
<li>Immediately, Minecraft finds the world on your <em>hard drive</em> where it has been saved for months</li>
<li>Minecraft copies all the files that make it a world and places it in RAM</li>
</ol>
<p>Now you are playing Minecraft in your favorite world! When you place a block down, that block is placed in the &quot;copied&quot; world that is currently in RAM. That's right, all of the changes you make before saving are in RAM; that's why games always tell you &quot;don't turn off while saving...&quot; because your RAM contents are essentially deleted when your system turns off. </p>
<p>So you place the block and save &amp; quit. Then close Minecraft. </p>
<ol>
<li>Your computer copies the content of the world in RAM and re-saves it over the world on your hard drive</li>
<li>Minecraft deletes the world copied into RAM</li>
<li>Minecraft sends a signal to the OS that it is done running</li>
<li>The OS gets that signal and destroyed the Minecraft copied into RAM. </li>
</ol>
<p>Here is a diagram to summarize everything that happened:</p>
<p><img src="3_computer_organization/./mc_in_ram.jpeg" alt="" /></p>
<p>Notice how this whole time we were playing on code that was copied into RAM. The entire time, the real Minecraft was sitting comfortably on your hard drive while a copy of it was doing all the world. As with everything you make changes to on your computer, copies are first placed into memory and then saved back to the hard drive after editing. </p>
<p>As you can see, we care about the response time of Minecraft so we copy it into memory. As with all things we need fast, they go in memory.</p>
<h2 id="observing-things-taking-memory"><a class="header" href="#observing-things-taking-memory">Observing things taking Memory</a></h2>
<p>Open up the fancy terminal again and install <code>htop</code>.</p>
<pre><code class="language-bash">sudo apt-get install htop
</code></pre>
<p><code>htop</code> is an upgraded version of <code>top</code>. It allows you to see what is running on your computer and how much &quot;things&quot; it is using. One of those things is memory. Run <code>htop</code> by typing the command <code>htop</code> in the terminal. You should see a big thing pop open, with what looks like a sound bar thing on the top of the screen. One of them is labeled <code>Mem</code> for Memory. It is of course your RAM usage. Right now, with nothing but a terminal open, you should be seeing no more than 1 Gig of memory being used. </p>
<p>For me it looks like this:</p>
<p><img src="3_computer_organization/./memory_in_use.png" alt="" /></p>
<p>Now go to your Ubuntu desktop and open <code>Firefox</code>. You should notice maybe half a gig of memory now being taken up. If you open more tabs and websites, then more RAM will be taken. This is memory in use! </p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Things exist in memory. When you run a program, it is put in memory. When you edit a file it is put in memory. When you run your Virtual Machine, it is put in memory. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="addressing"><a class="header" href="#addressing">Addressing</a></h1>
<p>In the last section about <a href="3_computer_organization/./programs_in_mem.html">programs in memory</a> we talked about loading Minecraft into memory (RAM). It was briefly mentioned that:</p>
<blockquote>
<p>When you click buttons in the Minecraft game, it simply transitions to different locations in memory where those button's code exists.</p>
</blockquote>
<p>The way it transitions to different locations in memory is through addressing. Like real life, addressing helps us find the places things live, in-memory for this case. In real life, someone would give you a unique string, their address, where you could find them in real life. Something like <code>411 North Central Ave, Phoenix, AZ</code>. In memory, we follow these same rules, but to a more simplified manner. </p>
<h2 id="linear-addresses"><a class="header" href="#linear-addresses">Linear Addresses</a></h2>
<p>The simplified manner is that memory has a very specific set of rules:</p>
<ol>
<li>Each address is unique</li>
<li>Each address is a number</li>
</ol>
<p>The number starts at zero and continues to whatever the <code>bit</code> count of the computer is. This fact should now help you realize what it means to have a <code>64bit</code> computer vs a <code>32bit</code> computer. In the old days, everything was <code>32bit</code>, but now everything is <code>64bit</code>. If you find some old applications, you may notice the option to download either—since programs made in 32bit are cross-compatible for 64bit. </p>
<p>Anyway, we will assume you are on a 64bit computer. That means the starting address, or the smallest address, is <code>0x0000000000000000</code> and the largest address is <code>0xFFFFFFFFFFFFFFFF</code>. You will notice this is an 8 byte range (also 64bit). Here is how you can visualize the memory in your computer:</p>
<pre><code>*----*----*----*----* 0x0000000000000000
|                   |
|-------------------|
|                   |
|-------------------|
|                   |
|-------------------|
|                   |
|         .         |
|         .         |
|         .         | 
|                   |
|-------------------| 
|                   |
*----*----*----*----* 0xFFFFFFFFFFFFFFFF
</code></pre>
<p>At each address is an 8 byte slot for data. This means we could store 8 bytes nearly 2**(64) times. That is wayyyyyyyyy more RAM than you have in your computer, but it is nice to know that our current architecture could support even a huge amount of RAM. </p>
<h2 id="reading--writing-data"><a class="header" href="#reading--writing-data">Reading &amp; Writing Data</a></h2>
<p>To simplify things, lets define two functions:</p>
<pre><code class="language-python">read(address) -&gt; outputs 8 bytes of data
write(address, content) -&gt; writes 8 bytes of data to address
execute(data) -&gt; executes the 8 bytes it's given
</code></pre>
<p>You can consider that when Minecraft launches the OS know where the beginning and end of Minecraft is. It records it with <strong>labels</strong>:</p>
<pre><code>minecraft_start = 0x0000000040000000
minecraft_end = 0x0000000050000000
</code></pre>
<p>Minecraft will of course take up a large portion of space:</p>
<pre><code>*----*----*----*----* 0x0000000000000000
|                   |
|                   |
|                   |
|-------------------| 0x0000000040000000
|                   |
|                   |
|     MINECRAFT     |
|                   |
|                   |
|-------------------| 0x0000000050000000
|                   |
*----*----*----*----* 0xFFFFFFFFFFFFFFFF
</code></pre>
<p>Notice that Minecraft neither starts at the beginning nor at the end of memory. Any program can be loaded at any random place in memory. In addition, other magical things happen to actually allow you to break up a program into multiple places, called <a href="https://whatis.techtarget.com/definition/virtual-address">Virtual Addressing</a>. For now, consider things to be linear and continuous.</p>
<p>The OS does not know the exact location of the Minecraft Quit Button code. Instead, it only knows an <strong>offset</strong> from <code>minecraft_start</code>. Something like:</p>
<pre><code>mc_quit_btn_offset = 0x80
</code></pre>
<p>Note: assume there are the correct amount of 0's on the other side of values when they are small like <code>0x80</code>. This is all still 64bits</p>
<p>Now to run the Minecraft Quit Button, the OS simply reads the offset, then executes it. </p>
<pre><code class="language-python">code = read(minecraft_start + mc_quit_btn_offset)
execute(code)
</code></pre>
<pre><code>*----*----*----*----* 0x0000000000000000
|                   |
|                   |
|                   |
|-------------------| 0x0000000040000000
|                   | &lt;--------- mc_quit_btn_offset
|                   |
|     MINECRAFT     |
|                   | 
|                   |
|-------------------| 0x0000000050000000
|                   |
*----*----*----*----* 0xFFFFFFFFFFFFFFFF
</code></pre>
<p>Other things happen, but for now understand that each thing is accessed as an offset. The same goes for writing over the contents of the map:</p>
<pre><code class="language-python">write(minecraft_start + mc_map_offset)
</code></pre>
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<p>Things are laid-out in memory in a linear format. Each location in memory can be addressed by an address (usually referred to in hex). At each address you can store data and read data. All-in-all, we have a large place that we can read and write too using numbers as our address. We usually refer to locations as offsets of known labels.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="memory-segments"><a class="header" href="#memory-segments">Memory Segments</a></h1>
<h2 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h2>
<p>In the last section, you learned that programs exist in memory. What you may not realize though is that we have segments, or divisions, of memory we a program is running. We call the addressing of these different memory segments a <a href="https://en.wikipedia.org/wiki/Memory_map">memory map</a>. Let's print the memory map of a process. Run the command below:</p>
<pre><code class="language-bash">sleep 5 &amp; cat &quot;/proc/$!/maps&quot;
</code></pre>
<p>This will run the <code>sleep</code> command (which sleeps for 5 seconds), and while it is running use the <code>pmap</code> command to print out the memory map of the process (which is the running memory instance of sleep). If you end up not being able to run this line, install pmap with <code>sudo apt-get install pmap -y</code>. Here is what the result should look similar to on your system:</p>
<pre><code>[1] 243862
55ce021ae000-55ce021b0000 r--p 00000000 08:05 3540380                    /usr/bin/sleep
55ce021b0000-55ce021b4000 r-xp 00002000 08:05 3540380                    /usr/bin/sleep
55ce021b4000-55ce021b6000 r--p 00006000 08:05 3540380                    /usr/bin/sleep
55ce021b7000-55ce021b8000 r--p 00008000 08:05 3540380                    /usr/bin/sleep
55ce021b8000-55ce021b9000 rw-p 00009000 08:05 3540380                    /usr/bin/sleep
55ce03d2d000-55ce03d4e000 rw-p 00000000 00:00 0                          [heap]
7f4055792000-7f4055d02000 r--p 00000000 08:05 3545607                    /usr/lib/locale/locale-archive
7f4055d02000-7f4055d27000 r--p 00000000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055d27000-7f4055e9f000 r-xp 00025000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055e9f000-7f4055ee9000 r--p 0019d000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055ee9000-7f4055eea000 ---p 001e7000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055eea000-7f4055eed000 r--p 001e7000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055eed000-7f4055ef0000 rw-p 001ea000 08:05 3546309                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
7f4055ef0000-7f4055ef6000 rw-p 00000000 00:00 0
7f4055f0a000-7f4055f0b000 r--p 00000000 08:05 3546044                    /usr/lib/x86_64-linux-gnu/ld-2.31.so
7f4055f0b000-7f4055f2e000 r-xp 00001000 08:05 3546044                    /usr/lib/x86_64-linux-gnu/ld-2.31.so
7f4055f2e000-7f4055f36000 r--p 00024000 08:05 3546044                    /usr/lib/x86_64-linux-gnu/ld-2.31.so
7f4055f37000-7f4055f38000 r--p 0002c000 08:05 3546044                    /usr/lib/x86_64-linux-gnu/ld-2.31.so
7f4055f38000-7f4055f39000 rw-p 0002d000 08:05 3546044                    /usr/lib/x86_64-linux-gnu/ld-2.31.so
7f4055f39000-7f4055f3a000 rw-p 00000000 00:00 0
7ffd0bc85000-7ffd0bca6000 rw-p 00000000 00:00 0                          [stack]
7ffd0bd80000-7ffd0bd83000 r--p 00000000 00:00 0                          [vvar]
7ffd0bd83000-7ffd0bd84000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]
</code></pre>
<p>It's a lot of stuff, so let's break it down. The first column is the start address to end address of that memory region. The second column is the permissions. The fifth column is the size of that mapped data (as it stands right now). The sixth column is the name of that mapping, which is not required. </p>
<blockquote>
<p>Note: it is common in computer science that if something does not have a name it is called &quot;anonymous.&quot; Sometimes that name will be shorted to just &quot;anon.&quot; </p>
</blockquote>
<p>I won't talk about the other columns because they aren't important for our example. </p>
<h2 id="important-maps"><a class="header" href="#important-maps">Important Maps</a></h2>
<p>Using the output from the command above, we can make a little reduced table of the output:</p>
<div class="table-wrapper"><table><thead><tr><th>Address Range</th><th>Permissions</th><th>Name</th></tr></thead><tbody>
<tr><td>55ce021ae000-55ce021b0000</td><td>r--p</td><td>/usr/bin/sleep</td></tr>
<tr><td>55ce021b8000-55ce021b9000</td><td>rw-p</td><td>/usr/bin/sleep</td></tr>
<tr><td>55ce021b0000-55ce021b4000</td><td>r-xp</td><td>/usr/bin/sleep</td></tr>
<tr><td>55ce03d2d000-55ce03d4e000</td><td>rw-p</td><td>heap</td></tr>
<tr><td>7ffd0bc85000-7ffd0bca6000</td><td>rw-p</td><td>stack</td></tr>
</tbody></table>
</div>
<p>We will refer to these as maps 1 through 5. </p>
<h2 id="program-memory"><a class="header" href="#program-memory">Program Memory</a></h2>
<p>Maps 1, 2, and 3 refer to the memory of the program. This is a fundamental difference from the memory of the process that is running this program. We will talk about processes more in the <a href="3_computer_organization/../5_processes/indroduction.html">processes</a> section, but for now you can consider a process to be a bunch of things mapped in memory along with the program. </p>
<p>Back to our program mapped in memory. Maps 1, 2, and 3 are the memory with talked about in <a href="3_computer_organization/./programs_in_mem.html">programs-in-memory</a> with the Minecraft example. You will notice that although all these mappings are for the same thing, they have different permissions per-split. </p>
<p>Map 1 is a read-only section of the program. You could consider this to be the place in the program where unchangeable non-code things are stored. Things like constant strings, png's of Minecraft blocks, and stuff you will not modify while the program runs.</p>
<p>Map 2 is a read-write section of the program. You could consider this to be the place in the program where you can store and modify things. Things like names could be stored here. The username of your player in Minecraft may change while you play the game (you could change it at Mojang), which means this name is not constant and needs to be writeable. It could be stored here. Usually, these writeable sections in your program have a special name like <code>.data</code> or <code>.bss</code>.</p>
<p><img src="3_computer_organization/./minecraft_username.jpg" alt="" /></p>
<p>Map 3 is a read-and-execute section of the program. In modern programs, this is the only mapping in the program that is executable. This is the place where the actual code of the program is stored. In Minecraft, this would be things like the logic for moving around your player, saving the world, placing blocks... everything. It's where the actual code that will be executed is stored. We will learn later that this is where instructions are stored. </p>
<p>There are also more mappings in the program for other things, but you will notice that their permissions are all iterations of the maps we described above.</p>
<h2 id="heap"><a class="header" href="#heap">Heap</a></h2>
<p>The Heap is a section of memory in every process (the stuff mapped with the program) that is dedicated to being a large writeable space. You might be asking yourself: &quot;Why does this need to exist? Why can't we just write everything in the writeable section of the program?&quot; Let's continue to use Minecraft as our running example to answer this question. </p>
<p>In Minecraft, as you roam around the world you may notice things coming in and out of view. The map, with all its AI and moving objects, is a large piece of data that is changing in memory all the time as you move. The amount that will be loaded in memory at any given time is completely unknown. You could, for instance, walk into a piece of the map where you built a 10000 chicken prison. That many chickens would absolutely destroy the program's memory if it could not <em>expand</em>. You could also turn up or down the render distance (the view distance), which would increase or decrease the amount of the map loaded at a given time.</p>
<p><img src="3_computer_organization/./render_distance.png" alt="" /></p>
<p>To make things easy, we made a section of memory that is both large and expandable: the Heap! We put large things in the Heap because the Heap can get bigger or smaller as we need it. As a side note, when you need more space in the heap, the range of the end mapping gets bigger (expands up).</p>
<h2 id="stack"><a class="header" href="#stack">Stack</a></h2>
<p>The Stack is another section of memory in every process that is dedicated to being a medium-sized writeable space that is <strong>very</strong> fast. How fast? It can often be around <a href="https://publicwork.wordpress.com/2019/06/27/stack-allocation-vs-heap-allocation-performance-benchmark/">100x</a> faster than using the heap, but it is also way less secure and has way less rules. For now, we will just ask you to believe us when we say the stack is much easier to corrupt than the heap, since you will learn that <strong>very</strong> technically if you finish this handbook and do the <a href="https://dojo.pwn.college/challenges/memory">memory errors</a> module from pwn.college. </p>
<p>So we have this faster less secure section of memory. We can't but everything there because it's insecure, but we can put small things that change often. In Minecraft, your username does not change <em>that frequently</em>, so it should not go here. When we say frequently, we mean a few dozen times in a second. </p>
<p>Something that changes that frequently in Minecraft, but is pretty small, is the space in memory where we store the letters you type in the Multiplayer chat.</p>
<p><img src="3_computer_organization/./minecraft_chat.png" alt="" /></p>
<p>The chat constantly gets new letters that exist, then don't exist. For the chat history, we save that in the Heap. But for a single sentence you are about to send to the chat, we put in the Stack. It changes fast and needs that speed for players to get angry at their respective toasters. </p>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>There is a pattern among the usage of these writeable sections in memory:</p>
<div class="table-wrapper"><table><thead><tr><th>Name</th><th>Data changes</th><th>Date is Large</th><th>Data changes Often</th></tr></thead><tbody>
<tr><td>Writeable program space</td><td>X</td><td></td><td></td></tr>
<tr><td>Heap</td><td>X</td><td>X</td><td></td></tr>
<tr><td>Stack</td><td>X</td><td></td><td>X</td></tr>
</tbody></table>
</div>
<p>You use a program's writeable space when it's small and does not change much. Heap when it's large. Stack when it's small and rapidly changing. </p>
<p>With everything you know now, this image of a processes memory should make sense:</p>
<pre><code>*----*----*----*----*----* 0x0000000000000000
|                        |
|       MINECRAFT        |
|------------------------|
|                        |
|         HEAP           |
|                        |
|------------------------|
|          |             |
|          v             |
|                        |
|                        |
|          ^             |
|          |             |
|------------------------|
|         STACK          |
*----*----*----*----*----| 0xFFFFFFFFFFFFFFFF
</code></pre>
<p>When <code>Minecraft</code> is running, its program memory stays stationary. The Heap that it uses to store large changing things grows up (in addressing space) towards the Stack. The Stack that it uses to store small changing things grows down (in the addressing space) towards the Heap. All the other things you can see stored in memory in the initial maps we got are other programs that assist the main program while it runs. This can be things like external libraries (code others have written that you reuse).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assembly"><a class="header" href="#assembly">Assembly</a></h1>
<p>Following our talk on the section on bits, we can now address the computer
looking section of our chapter, <strong>Assembly</strong>.</p>
<p>An assembly language, better referred to as an <a href="https://en.wikipedia.org/wiki/Instruction_set_architecture">ISA</a>, is the lowest level of instructions that run on a computer. These instructions, or operations on data, are predefined by the hardware you use! At the lowest level, each instruction in an ISA is a combination of logic gates that you have already learned. Before continuing, watch this 15 minutes video on what an architecture is by Yan <a href="https://www.youtube.com/watch?v=9jc0eSnrzF4">here</a>.</p>
<p>* * *</p>
<p>As far as ISA's go, there are two types:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Reduced_instruction_set_computer">RISC</a>: Reduced Instruction Set Computer</li>
<li><a href="https://en.wikipedia.org/wiki/Complex_instruction_set_computer">CISC</a>: Complex Instruction Set Computer</li>
</ul>
<p>RISC and CISC are competitors and mostly differ in the side-effects their instructions have on memory. If you are interested in this difference, then you can read what <a href="https://cs.stanford.edu/people/eroberts/courses/soco/projects/risc/risccisc/">Stanford has to say on the matter</a>, but it's not required. For this handbook we will be only using and referring to assembly for <a href="https://en.wikipedia.org/wiki/X86-64">Intel x86_64</a>.</p>
<h2 id="intel-x86_64-assembly"><a class="header" href="#intel-x86_64-assembly">Intel x86_64 Assembly</a></h2>
<p>The assembly language we will be studying in this handbook is by no means the best assembly language to start with. Ideally, we would've started with a RISC architecture because they are easier to learn, but, the world had different ideas. </p>
<p>There is an extremely high probability that you are reading this text on an Intel x86_64 machine. Dell, Lenovo, Apple; they all run x86_64. The only exception is the recent Mac M1 processor, but for the most part, the world's computers run on the Intel ISA. With that knowledge, I though it was most practical to teach you the most common architecture.</p>
<h2 id="how-to-read-the-rest-of-this-section"><a class="header" href="#how-to-read-the-rest-of-this-section">How to read the rest of this section</a></h2>
<p>It's time we dive into x86_64, which we will shorthand to <em>x86</em> from now. All the subsections in this section should be read in an <em>overview</em> manner. I wrote these modules to assist and act as a reference for the challenges associated with this section. </p>
<p>The challenges you will complete as part of this section are the EmbryoASM challenges hosted on pwn.college. Myself and @redgate wrote these challenges to teach you assembly rather than just test your skill. You will find the challenges on the <a href="https://dojo.pwn.college/challenges/asm">dojo</a>. Start them after reading the sections below. </p>
<h2 id="quick-reference-links"><a class="header" href="#quick-reference-links">Quick Reference Links</a></h2>
<ul>
<li>
<p>Instructions</p>
<ul>
<li><a href="https://defuse.ca/online-x86-assembler.htm">Encoding</a></li>
<li><a href="https://www.felixcloutier.com/x86/">Reference/Description</a></li>
</ul>
</li>
<li>
<p>Syscalls</p>
<ul>
<li><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md">Calling Convention</a></li>
</ul>
</li>
<li>
<p>Challenges</p>
<ul>
<li><a href="https://dojo.pwn.college/challenges/asm">EmbryoASM</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="registers"><a class="header" href="#registers">Registers</a></h1>
<h2 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h2>
<p>Welcome to the land of x86. The first thing you need to learn is where <em>things</em> are stored when you run instructions. What's in an instruction? What's a thing? Let's start with some simple math examples. </p>
<p>In math, you often have variables where you store things. Often, those things are numbers. </p>
<pre><code>x = 10
x = x + 4
x = x / 2 
x = x - 1
</code></pre>
<p>We can assign values, reassign values, and do general computation on them. The nice thing about math is that a variable has no size. When you think about assigning a value to <code>x</code>, you never wonder: will the value fit in x? As an example:</p>
<pre><code>x = 18446744073709551616
</code></pre>
<blockquote>
<p>Note: From now on, 'x ** y' means x to the y power and 'x ^ y' means x <em>xored</em> with y. </p>
</blockquote>
<p>In the last section, we talked about bits and hex. This value is actually <code>0xffffffffffffffff + 1</code>. The number of bits it would take to represent this number would be <code>65</code> bits <code>(2 ** 64) + 1</code>. In computer science, when we say: &quot;what is the size of x&quot;, we are usually talking about the number of bits that value takes up. To make things easier to say in a short sentence, we instead say the size in the number of bytes. </p>
<blockquote>
<p>Recall: 8 bits == 1 byte</p>
</blockquote>
<p>In x86, and most assembly languages, you have registers which act as variables for doing computation. In x86 (the 64 bit version), registers are 64 bits large (8 bytes). As you may be guessing, in x86 32 bit, the registers are 32 bits large. </p>
<p>Each register in x86 has a name. Here are their names:</p>
<pre><code>rax
rbx
rcx
rdx
rbp
rsp
rsi
rdi
rip
r8 
r9 
r10
r11
r12
r13
r14
r15
</code></pre>
<p>For now, we just say that any of these registers can hold a number that is up to 64 bits large. In reality, each of these registers are used for different actions in x86. Here is a good <a href="https://wiki.cdot.senecacollege.ca/wiki/X86_64_Register_and_Instruction_Quick_Start">register use reference list</a> for later.</p>
<h2 id="using-registers"><a class="header" href="#using-registers">Using Registers</a></h2>
<p>Each register can be accessed in different ways. Why must you always use all 64 bits of a register. Take this for example: say we want to set <code>rax</code> == <code>0xffffffffffffffff</code>, but we already know <code>rax</code> has <code>0xffffffff00000000</code>:</p>
<pre><code class="language-c">// we know rax = 0xffffffff00000000

eax = eax | 0xffffffff 

// now rax = 0xffffffffffffffff
</code></pre>
<p>In this example we used a logical OR instruction covered in <a href="3_computer_organization/./bits_and_logic.html">bits-and-logic</a> to OR the bottom 32 bits of <code>rax</code>. The way you access the bottom 32 bits or <code>rax</code> is with <code>eax</code>. It just so happens that every register has splits like this.
Here is an illustration of all the bits and how you can access them:</p>
<pre><code>MSB                  32        16    8   0   
+----------------------------------------+
|                   rax                  |
+--------------------+-------------------+
                     |        eax        |
                     +---------+---------+
                               |   ax    |
                               +----+----+
                               | ah | al |
                               +----+----+
</code></pre>
<p>MSB here stands for Most Significant Bit, or the high part we referred to earlier. As an example, you can access the first 8 bits of <code>rax</code> by reading from <code>al</code>. All registers have name access like this. See <a href="https://wiki.cdot.senecacollege.ca/wiki/X86_64_Register_and_Instruction_Quick_Start">this reference</a> for more use cases. In most cases, you just change the first two letters to access different parts like shown above. </p>
<h2 id="special-registers"><a class="header" href="#special-registers">Special Registers</a></h2>
<p>Some registers are special and will make more sense later. Here they are:</p>
<ul>
<li>rbp: the stack base pointer (bp)</li>
<li>rip: the instruction pointer (ip)</li>
<li>rsp: the stack pointer (sp)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="instructions"><a class="header" href="#instructions">Instructions</a></h1>
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p>So you've learned where to store numbers in assembly, <a href="3_computer_organization/./registers.html">registers</a>. Your next logical question would be: <strong>how</strong> do I store values in those registers? Good question. You store them using <em>instructions</em>. </p>
<p>Instructions are <em>atomic</em> pieces of logic that run in order on the CPU. That sounds complicated, so let's break it down. Here is an example of something we want to do:</p>
<pre><code class="language-c">x = 10 
</code></pre>
<p>In assembly, where <code>x is rax</code>, this translates to:</p>
<pre><code class="language-c">mov rax, 10
</code></pre>
<blockquote>
<p>It's important to note that this format of x86 is in the flavor of Intel. There are two flavors: <a href="https://imada.sdu.dk/~kslarsen/dm546/Material/IntelnATT.htm">Intel and AT&amp;T</a>. For all the challenge, and this handbook, we will be using Intel format. </p>
</blockquote>
<p>This instruction is atomic because nothing can interrupt it and it is the lowest level of logic on a computer. In contrast, we could show this operation:</p>
<pre><code class="language-c">x = x + 10
</code></pre>
<p>The thing we are asking to do above is not atomic. It is actually composed of 3 parts (normally):</p>
<pre><code class="language-c">mov rbx, rax     // make a temp for x
add rbx, 10      // add 10 to that temp
mov rax, rbx     // move the temp back into x
</code></pre>
<p>You will also notice that these instructions execute one-after-another. They are linearly executed.</p>
<h2 id="instruction-syntax"><a class="header" href="#instruction-syntax">Instruction Syntax</a></h2>
<p>This syntax may be confusing but most instructions follow the same format:</p>
<pre><code>&lt;instruction_mnemonic&gt;  &lt;destination&gt;, &lt;source&gt;
</code></pre>
<p>So saying: <code>mov rax, rbx</code> means <code>move rbx to rax</code>. </p>
<p>There are some other more subtle things in this syntax, like the use of <code>[&lt;register_name&gt;]</code> in instructions. </p>
<blockquote>
<p>Recall: when we say [0x400000] this refers to the data at the address 0x400000. Review <a href="3_computer_organization/./memory.html">memory</a> for a recap.</p>
</blockquote>
<p>For instance:</p>
<pre><code>mov rax, [rbx]
</code></pre>
<p>This means move the <strong>the value at the address stored in rbx</strong> to rax. Usually other blogs and such will refer to this process as dereferencing rbx. </p>
<h2 id="instruction-execution"><a class="header" href="#instruction-execution">Instruction Execution</a></h2>
<p>In the <a href="3_computer_organization/./registers.html">registers</a> section we talked a little about special registers. Now it's time to talk about the most important of those special registers: <strong>rip</strong> (also referred to as ip).</p>
<p>IP in assembly land refers to the Instruction Pointer register. You can find an ip register in every architecture. This instruction is responsible for storing the address of the instruction we are supposed to be executing right now. Normally, when you have instructions that are a program they are laid out in memory. Here is how a typical memory layout full of instructions could look:</p>
<pre><code class="language-c">000000000000112d &lt;main&gt;:
112d:       push   rbp
112e:       mov    rbp,rsp
1131:       mov    [rbp-0x8], 0x0
1138:       mov    [rbp-0x4], 0x4
113f:       mov    eax, [rbp-0x4]
1142:       add    eax, 0x5
1145:       mov    [rbp-0x8], eax
1148:       mov    eax, [rbp-0x8]
114b:       imul   eax, [rbp-0x4]
114f:       mov    [rbp-0x8], eax
</code></pre>
<p>There are some important things to note here. First, you can dereference registers while adding or subtracting an offset to it like in <code>[rbp - 0x4]</code>. Second, the address each instruction is associated with is not singly incremental. Notice how the difference in address between some instructions is <code>7</code>, while others are only <code>1</code>. You may have guessed it, but the difference in addresses for each instruction is based on that instruction's size.</p>
<p>Each instruction is composed of bytes that encode it. Here is the same code from above, but printed with its encoding:</p>
<pre><code class="language-c">000000000000112d &lt;main&gt;:
112d:       55                      push   rbp
112e:       48 89 e5                mov    rbp,rsp
1131:       c7 45 f8 00 00 00 00    mov    [rbp-0x8], 0x0
1138:       c7 45 fc 04 00 00 00    mov    [rbp-0x4], 0x4
113f:       8b 45 fc                mov    eax, [rbp-0x4]
1142:       83 c0 05                add    eax, 0x5
1145:       89 45 f8                mov    [rbp-0x8], eax
1148:       8b 45 f8                mov    eax, [rbp-0x8]
114b:       0f af 45 fc             imul   eax, [rbp-0x4]
114f:       89 45 f8                mov    [rbp-0x8], eax
</code></pre>
<p>There is a lot of different semantics to encoding instructions, such as their type and operation, but I won't be talking about how you can encode instructions by hand in this handbook. If you are interested, check <a href="https://wiki.osdev.org/X86-64_Instruction_Encoding#Opcode">this out</a>.</p>
<p>If you are curious about how an instruction encodes into its bytes (or the other way around), use <a href="https://defuse.ca/online-x86-assembler.htm">this site</a> to encode and decode x86 instructions as you like. I use it often for CTFs since it's so easy to use.</p>
<p>Now back to our earlier discussion, the instruction pointer. Execution of instructions follows the <a href="https://en.wikipedia.org/wiki/Instruction_cycle">fetch-and-execute</a> cycle:</p>
<ol>
<li>Get the instruction at the address of the ip</li>
<li>Decode it</li>
<li>Execute it </li>
<li>Add the size of the current instruction to the ip</li>
<li>Repeat </li>
</ol>
<p>So if in our previous example we are about to execute <code>mov [rbp-0x8], 0x0</code>, that means that <code>rip = 0x1131</code>. This also means that <code>[0x1131]</code> is the bytes of the instruction <code>mov [rbp-0x8], 0x0</code>.</p>
<p>The last thing to know about <code>rip</code>, and <code>ip</code> in general, is that you are not allowed to modify this register yourself. Obviously you just having instructions in memory modifies <code>rip</code>, but you are not allowed to do things like:</p>
<pre><code>mov rip, 0x1138
</code></pre>
<p>That is an illegal instruction.</p>
<h2 id="common-instructions"><a class="header" href="#common-instructions">Common Instructions</a></h2>
<p>So you know instructions can do things, but what kind of instructions exist? Here are the most common instructions you will use/see in the wild:</p>
<blockquote>
<p>Note: when you see &lt;x | y&gt; it means that thing could be an <code>x</code> or a <code>y</code>; <code>C</code> means a constant, like <code>10</code>; <code>stack</code> means the stack (a region of memory) and is represented by a list.</p>
</blockquote>
<h3 id="math-operations"><a class="header" href="#math-operations">Math Operations</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Mnemonic</th><th>Arguments</th><th>Description</th><th>Python Equiv</th><th></th></tr></thead><tbody>
<tr><td>add</td><td>r1, &lt;r2 | C&gt;</td><td>Adds r2 to r1.</td><td>r1 += r2</td><td></td></tr>
<tr><td>sub</td><td>r1, &lt;r2 | C&gt;</td><td>Subtracts r2 from r1.</td><td>r1 -= r2</td><td></td></tr>
<tr><td>idiv</td><td>rax=divisor; rdx=dividend</td><td>Divides rdx by rax. Result in rax, remainder in rdx.</td><td>rdx // rax; rdx % rax</td><td></td></tr>
<tr><td>imul</td><td>r1, &lt;r2 | C&gt;</td><td>Multiplies r1 by r2.</td><td>r1 *= r2</td><td></td></tr>
</tbody></table>
</div>
<blockquote>
<p>Note: modulo can be accomplished with idiv and reading the value in rdx.</p>
</blockquote>
<p>The math operations above can be done both in a <a href="https://math.libretexts.org/Bookshelves/PreAlgebra/Book%3A_Fundamentals_of_Mathematics_(Burzynski_and_Ellis)/10%3A_Signed_Numbers/10.06%3A_Multiplication_and_Division_of_Signed_Numbers">signed and unsigned</a> way. This means that the numbers can be represented negatively or non-negatively which changes how we represent the output of the number.</p>
<blockquote>
<p>Recall: in <a href="3_computer_organization/./bits_and_logic.html">bits-and-logic</a> that we can represent negative values in x86 using <a href="https://en.wikipedia.org/wiki/Two%27s_complement">Two's Complement</a>, which makes the upper bits of a value <code>1</code> to represent negative. This affects how instructions output values. </p>
</blockquote>
<h3 id="logic-operations"><a class="header" href="#logic-operations">Logic Operations</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Mnemonic</th><th>Arguments</th><th>Description</th><th>Python Equiv</th><th></th></tr></thead><tbody>
<tr><td>and</td><td>r1, &lt;r2 | C&gt;</td><td>Logically ANDs r1 with r2</td><td>r1 &amp;= r2</td><td></td></tr>
<tr><td>or</td><td>r1, &lt;r2 | C&gt;</td><td>Logically ORs r1 with r2</td><td>r1 |= r2</td><td></td></tr>
<tr><td>xor</td><td>r1, &lt;r2 | C&gt;</td><td>Logically XORs r1 with r2</td><td>r1 ^= r2</td><td></td></tr>
<tr><td>not</td><td>r1</td><td>Logically NOTs r1 and sets it to r1</td><td>r1 = ~r1</td><td></td></tr>
</tbody></table>
</div>
<h3 id="storage-operations"><a class="header" href="#storage-operations">Storage Operations</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Mnemonic</th><th>Arguments</th><th>Description</th><th>Python Equiv</th><th></th></tr></thead><tbody>
<tr><td>mov</td><td>r1, &lt;r2 | C&gt;</td><td>Copies value in r2 and stores it in r1</td><td>r1 = r2</td><td></td></tr>
<tr><td>lea</td><td>r1, [r2 + C]</td><td>Stores computed address of r2+C in r1</td><td>r1 = r2 + C</td><td></td></tr>
<tr><td>push</td><td>&lt;r1 | C&gt;</td><td>Places r1 on the top of the stack</td><td>stack += [r1]</td><td></td></tr>
<tr><td>pop</td><td>r1</td><td>Removes value on top of stack, places in r1</td><td>r1 = stack.pop()</td><td></td></tr>
</tbody></table>
</div>
<p>You don't know what the stack is yet, but we will get to it in the <a href="3_computer_organization/./asm_memory.html">asm-memory</a> section.</p>
<hr />
<p>There is actually one more set of instructions we need to cover, and that's <em>control flow operations</em>, or operations that change the execution of the program (alter ip). They are so important that they get their own header.</p>
<h2 id="control-flow-instructions"><a class="header" href="#control-flow-instructions">Control Flow Instructions</a></h2>
<p>You understand how to do things linearly, but that's boring. You don't always want to do things so linearly. You often want conditions! Something like:</p>
<pre><code class="language-python">if(x is even):
    y = x + 1
else:
    y = x
</code></pre>
<p>In x86 you represent these types of things with conditional jumps. </p>
<h3 id="jump-instructions"><a class="header" href="#jump-instructions">Jump Instructions</a></h3>
<p>All jump instructions start with a <code>j</code>, go figure. Normal jumps, called unconditional jumps look like this:</p>
<pre><code>jmp 0xdeadbeef
</code></pre>
<p>Where you replace 0xdeadbeef with an address of some sort. This also works with registers, so <code>jmp [rax]</code> is a very valid thing too and introduces its own complexities. Conditional jumps start with a <code>j</code> and end with some mnemonic to signify what they are dependent on. As an example, you have <em>jump if less than or equal</em>:</p>
<pre><code>jle 0xdeadbeef
</code></pre>
<p><code>le</code> is dependent on something called the <a href="https://en.wikipedia.org/wiki/FLAGS_register">flags register</a>, which is altered based on instructions that cause comparisons and tests. The two most common comparisons are:</p>
<pre><code>cmp r1, &lt;r2 | C&gt;
test r1, r2
</code></pre>
<p><code>cmp</code> will subtract <code>r2</code> from <code>r1</code> to tell the difference. <code>test</code> will <code>AND</code> the two to tell the difference. These differences are stored in the flags registers. The most common format of their use is like so:</p>
<pre><code>cmp rax, rdx
jle addr2
addr1:
mov rbx, 1
jmp addr3
addr2:
mov rbx, 0
addr3:
mov rax, rbx
</code></pre>
<p>The use of the names like <code>addr1</code> here are labels. You can place labels anywhere in assembly and use them in jump instructions later. Thse labels will be converted into relative jumps at the time the code is assembled (right before running it).</p>
<p><strong>RECAP</strong>:</p>
<ul>
<li>Unconditional Jump: <code>jmp address</code></li>
<li>List of all conditional jumps: <a href="http://unixwiz.net/techtips/x86-jumps.html">here</a></li>
<li>Register flags: <a href="https://riptutorial.com/x86/example/6976/flags-register">here</a></li>
<li>cmp instruction: <a href="https://www.aldeid.com/wiki/X86-assembly/Instructions/cmp">here</a></li>
<li>test instruction <a href="https://en.wikipedia.org/wiki/TEST_(x86_instruction)">here</a></li>
</ul>
<h3 id="call-instructions"><a class="header" href="#call-instructions">Call Instructions</a></h3>
<p>Finally, we have the last subset of instructions and that's call related instructions. They are a sub-set of control flow altering instructions and they work very much like jumps. There are two instructions:</p>
<ol>
<li><a href="https://www.felixcloutier.com/x86/call">call</a></li>
<li><a href="https://www.felixcloutier.com/x86/ret">ret</a></li>
</ol>
<p>Call works like this:</p>
<pre><code>call &lt;r1 | C&gt;
</code></pre>
<p>So you can call an address, label (like in the jumps), or a dereferenced register (<code>[rax]</code>). When you call something it actuall does two things:</p>
<pre><code>call addr:
1. decode instruction
2. push (rip + current_instruction_size)
3. jmp addr
</code></pre>
<p>You still don't know what the stack is, but know that its somewhere you can save stuff just like normal memory. If you push something on the stack, it is now saved on the stack until a corresponding pop. So, from this, we can extrapolate that a call instruction does a jump while saving the original next address on the stack. This save is for the corresponding instruction <code>ret</code>. The <code>ret</code> instruction takes optional args, but for now we will consider it takes nothing:</p>
<pre><code>ret
</code></pre>
<p>The ret instruction does the following:</p>
<pre><code>ret:
1. pop rip
</code></pre>
<p>So it directly modifies <code>rip</code> by taking whatever is on top of the stack and putting it into <code>rip</code>. So, in normal code, you can make a region of code you can reuse many times, called a <em>function</em>:</p>
<pre><code class="language-c">// args in rdi, output in rax
make_even:
mov rdx, rdi
mov rax, 2 
idiv 
mov rax, rdx    
cmp rax, 0 
je make_even_done
add rdi, 1
make_even_ret:
mov rax, rdi
ret

_start:
mov rdi, 10
call make_even
mov rdi, rax
...
</code></pre>
<p>This code above shows off the power of the <code>call</code>, <code>ret</code> combo, allowing you to return to execution after you do some action with registers and values. It also shows how to make a function, which we will cover more in <a href="3_computer_organization/./control_structures.html">control-structures</a>.</p>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<p>There are many instructions that make up the x86-64 architecture. It's actually one of the largest. You can find all instructions at the <a href="https://www.felixcloutier.com/x86/">felixcloutier site</a>, which I often use for references of hard-to-remember instructions. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="memory-1"><a class="header" href="#memory-1">Memory</a></h1>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<p>You've already learned about <a href="3_computer_organization/./memory.html">memory</a>, how you can access it with addresses, and how programs often live in memory with other memory segments like the Heap and Stack. Surprise, surprise, the programs we can write with instructions live in memory as well. With our new knowledge of instructions, you can use this memory to store things that may be very large or of an unknown length. </p>
<h2 id="memory-and-lists"><a class="header" href="#memory-and-lists">Memory and Lists</a></h2>
<p>Using instructions like <code>mov</code> you can access the data at some memory location. Say another part of the program provided you with the memory address to a writeable place in memory. You could write to it like so:</p>
<pre><code class="language-c">// rax = memory addr

mov [rax], 0x1337
</code></pre>
<p>Now, let's say we wanted to make a <strong>list</strong> of numbers. We say this list would be 4 numbers large and look like:</p>
<pre><code class="language-python">my_list = [2, 4, 8, 16]
</code></pre>
<p>Assuming the memory at <code>my_list</code> label has enough space, we could set up the list like so:</p>
<pre><code class="language-c">// my_list is a label to some free data we can write too
mov rax, my_list
mov [rax], 0x2
mov [rax+4], 0x4
mov [rax+8], 0x8
mov [rax+0xc], 0x10
</code></pre>
<p>In this example, we assumed that the number will be at a max of 4 bytes large. This is important and changes the way we could get the memory back. Say we now wanted to use the data we stored in memory. We would now need to use 4 byte versions of our registers to assure we get the right number (since its only 4 bytes, not 8):</p>
<pre><code class="language-c">// my_list is a label to data with numbers of size 4 bytes
mov rax, my_list
mov edi, [rax]
mov esi, [rax+4]
mov edx, [rax+8]
mov ecx, [rax+0xc]
</code></pre>
<h2 id="stack-1"><a class="header" href="#stack-1">Stack</a></h2>
<p>You may remember from the <a href="3_computer_organization/./memory_segments.html">memory-segments</a> section that we have two special writeable locations in memory: the Stack and the Heap. For the purpose of simplicity, we don't go over how to access and use the Heap in this module since it requires using more complicated instructions. For now, we can just use writeable program memory as we would the Heap since we can consider the case where all we get is an address to a writeable location.</p>
<p>The Stack is very similar to normal writeable locations. It has addresses and it can be directly dereferenced like a normal address. The Stack is special though because it works like a literal stack (think stacking pancakes), and it has a dedicated register (<code>rsp</code>), to tell you where the top of the stack currently is. </p>
<h3 id="working-with-the-pancake-stack"><a class="header" href="#working-with-the-pancake-stack">Working with the Pancake Stack</a></h3>
<p>Say your mom places 3 pancakes on your plate: pancake 1, 2, and 3. </p>
<pre><code>Pancake Stack:

  #######################
  |      pancake 1      |
  #######################
  ~~~~~~~~~~~~~~~~~~~~~~~
  #######################
  |      pancake 2      |
  #######################
  ~~~~~~~~~~~~~~~~~~~~~~~
  #######################
  |      pancake 3      |
  #######################
|=========================|
</code></pre>
<p>You can't just access pancake 3, that would destroy the stack (and make your mom mad). You need to access pancake 1 first, then 2, then 3. When you access the pancake on the top, we call it a <code>pop</code>. Yes, you literally <code>pop</code> the pancake into your mouth. We represent that with the instruction:</p>
<pre><code class="language-c">pop mouth
</code></pre>
<p>Which results in the new pancake stack:</p>
<pre><code>Pancake Stack:

  #######################
  |      pancake 2      |
  #######################
  ~~~~~~~~~~~~~~~~~~~~~~~
  #######################
  |      pancake 3      |
  #######################
|=========================|
</code></pre>
<p>Now, the top of the stack is <code>pancake 2</code>. We would say the <code>pancake stack pointer</code> is pointing at the location where the second pancake is located now. It was originally pointing at the location of pancake 1, but we poped the stack. </p>
<p>So you <code>pop mouth</code> another pancake:</p>
<pre><code>Pancake Stack:

  #######################
  |      pancake 3      |
  #######################
|=========================|
</code></pre>
<p>Before you can do another pop, your mom pushes a fresh new pancake on your plate with the instruction:</p>
<pre><code>push pancake_4
</code></pre>
<p>Now the stack looks like:</p>
<pre><code>Pancake Stack:

  #######################
  |      pancake 4      |
  #######################
  ~~~~~~~~~~~~~~~~~~~~~~~
  #######################
  |      pancake 3      |
  #######################
|=========================|
</code></pre>
<p>Now the top of the stack points to pancake 4.</p>
<h3 id="working-with-the-real-stack"><a class="header" href="#working-with-the-real-stack">Working with the Real Stack</a></h3>
<p>Now you understand how the stack works. You can save stuff there temporarily with <code>push</code> and retrieve with <code>pop</code>. The special register <code>rsp</code> points to the top of the stack. When you do a <code>push</code> it results in <code>rsp -= 8</code>. When you <code>pop</code> it results in <code>rsp += 8</code>.</p>
<blockquote>
<p>Recall: the stack grows <em>down</em> by making the stack address smaller as you need more space. If you need to expand 8 bytes, you would subtract 8 from the rsp. </p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="control-structures"><a class="header" href="#control-structures">Control Structures</a></h1>
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>Control structures are patterns of assembly code that create some kind of more abstract flow controlling thing. As an example, the <code>if</code> statement we used earlier is a control structure. Control structures are used to make our code do interesting and complex things like make decisions in a loop, conditional do stuff, and easily make code reusable and understandable. </p>
<p>The first up of these control structures is one that makes code easy to reuse: functions!</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>A function is a piece of code that you can reuse more than once that can take some arguments and return some values. It's essentially just like a normal math function. Take for instance the classic <code>f</code> in math:</p>
<pre><code>f(x) = y
</code></pre>
<p>In this function above, it takes <code>x</code> and outputs <code>y</code>. You may not know how it translates <code>x</code> -&gt; <code>y</code>, but you know you get <code>y</code> from inputting <code>x</code>. You can make the same type of functions in x86 and most assembly languages. Earlier in <a href="3_computer_organization/./instructions.html#call-instructions">call-instructions</a>, we actually provided you with a function. Here it is again:</p>
<pre><code class="language-c">// args in rdi, output in rax
make_even:
mov rdx, rdi
mov rax, 2 
idiv 
mov rax, rdx    
cmp rax, 0 
je make_even_done
add rdi, 1
make_even_ret:
mov rax, rdi
ret
</code></pre>
<p>A very simple function to take whatever number it is given and make it even. If you are not sure how it does that, review <a href="3_computer_organization/./instructions.html">instructions</a> and how even and odd numbers work in math.</p>
<h3 id="calling-convention"><a class="header" href="#calling-convention">Calling Convention</a></h3>
<p>In this example, the first argument to the function (the input), is passed in rdi. The output is passed in rax. This passing of arguments and returns actually is called something. A <em>calling convention</em>. A calling convention is the way in which you pass arguments to a callable <em>thing</em>. The <em>thing</em> in this case is functions in x86. Just like flavors of syntax, there are <a href="https://riptutorial.com/x86/topic/3261/calling-conventions">many different calling conventions</a>. The most widely used calling convention, and the one you are most likely to see in the wild, is the <a href="https://riptutorial.com/x86/example/11197/64-bit-system-v">64-bit System V</a> calling convention. </p>
<p>In System V (<strong>the one we use here</strong>), this is how args are passed:</p>
<div class="table-wrapper"><table><thead><tr><th>Argument</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10+...</th><th>return</th></tr></thead><tbody>
<tr><td>Location</td><td>rdi</td><td>rsi</td><td>rdx</td><td>rcx</td><td>r8</td><td>r9</td><td>r10</td><td>r11</td><td>rsp</td><td>rsp+n</td><td>rax</td></tr>
<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
</tbody></table>
</div>
<p>Arguments passed 8 are all passed on the stack. Argument 9 would be <code>rsp</code>, 10 <code>rsp + 8</code>, and so forth. System V is the calling convention we will be using for the rest of the handbook and the EmbryoASM modules we will have you do at the end of this section. The return value is always one thing and its passed in rax. </p>
<p>Though we only use System V in the handbook, we felt it was worth it to mention that the 32 bit version of x86 uses <a href="https://riptutorial.com/x86/example/11196/32-bit-cdecl">cdecl</a> (commonly said as &quot;C-deck-ul). The cdecl calling convention passes all the arguments on the stack just like System V does for arguments 9 and above.</p>
<p>Now back to our concrete examples. Say we have a function called <code>sum4</code> that returns the sum of four numbers. If we have some assembly code and we wanted to call that function with the values <code>2, 4, 8, 16</code>, this is how we would do it:</p>
<pre><code class="language-c">// some earlier code...

mov rdi, 2
mov rsi, 4
mov rdx, 8
mov rcx, 16
call sum4

// some code after...
</code></pre>
<p>Cool right? Note we can easily reuse <code>sum4</code> as many times as we like. Just as a refresher, every function ends with a <code>ret</code> so that you can reliably use <code>call</code> on it as in the example above. </p>
<h3 id="functions-and-the-stack"><a class="header" href="#functions-and-the-stack">Functions and the Stack</a></h3>
<p>It's important to know that functions often use stacks to save arguments right at the beginning of the function. This is called the <a href="https://en.wikipedia.org/wiki/Function_prologue_and_epilogue">function prolouge</a>. The reason we save things on the stack is because we might need to reuse the original argument registers:</p>
<pre><code class="language-c">// takes 3 args
my_func:
call some_other_func 
ret
</code></pre>
<p>The way to fix this is by saving things on the stack:</p>
<pre><code class="language-c">//takes 3 args
my_func:
push rdi
push rsi
push rdx
call some_other_func
pop rdx
pop rsi
pop rdi
ret
</code></pre>
<p>This is very easy to do with pops and pushes, but is often not exactly correct. In real function, you will see use of <code>rbp</code> as well. Here is a snippet of code we used in the <a href="3_computer_organization/./instructions.html">instructions</a> section:</p>
<pre><code class="language-c">000000000000112d &lt;main&gt;:
112d:       push   rbp
112e:       mov    rbp,rsp
1131:       mov    [rbp-0x8], 0x0
1138:       mov    [rbp-0x4], 0x4
113f:       mov    eax, [rbp-0x4]
1142:       add    eax, 0x5
1145:       mov    [rbp-0x8], eax
1148:       mov    eax, [rbp-0x8]
114b:       imul   eax, [rbp-0x4]
114f:       mov    [rbp-0x8], eax
</code></pre>
<p>This code is a very accurate representation of what you will see in the real world. We use the special register rbp to save the original place the stack was at the start of the function. <code>bp</code> in rbp stands for Base Pointer. It's the base pointer of the stack, or where it was before calling this function. </p>
<p>To explain the above code more:</p>
<ol>
<li>the current base pointer is saved (to be popped at the end by a leave; ret;)</li>
<li>the stack pointer becomes the base pointer</li>
<li>the base pointer is used as if it was the sp</li>
</ol>
<p>This allows us to modify the sp as we like, then when the function is done, it gets fixed up. This idea will be expanded more in the EmbryoASM challenges.</p>
<h2 id="conditionals"><a class="header" href="#conditionals">Conditionals</a></h2>
<p>Conditionals run the world. Below you will find the most common structures translated into assembly, originally shown in python like code.</p>
<h3 id="if-statements"><a class="header" href="#if-statements">if statements</a></h3>
<p>High-level:</p>
<pre><code class="language-python">if x &gt; 0:
    y = 1
else:
    y = 0
</code></pre>
<p>ASM:</p>
<pre><code class="language-c">// rdi = x; rax = y
cmp rdi, 0
jle else_label
mov rbx, 1
jmp end_label

else_label:
mov rbx, 0

end_label:
mov rax, rbx
</code></pre>
<h3 id="else-if-statements"><a class="header" href="#else-if-statements">else-if statements</a></h3>
<pre><code class="language-python">if x == 0:
    y = 1
elif x &lt; 0:
    y = -1
else
    y = 0
</code></pre>
<p>ASM:</p>
<pre><code class="language-c">// rdi = x; rax = y
cmp rdi, 0
je if_label
jl else_if_label
mov rbx, 0
jmp end_label

if_label:
mov rbx, 1
jmp end_label

else_if_label:
mov rbx, -1

end_label:
mov rax, rbx
</code></pre>
<h2 id="loops"><a class="header" href="#loops">Loops</a></h2>
<p>Loops allow you to do something many times. Like: &quot;walk forward 18 times&quot; actually translates to &quot;walk forward&quot;*18. 
Here are two types of loops you can use:</p>
<h3 id="for-loop"><a class="header" href="#for-loop">For-loop</a></h3>
<p>When you know how many times you want to iterate, like the example above, you use a for-loop:
High-Level:</p>
<pre><code class="language-python">for i=0...18:
    walk_forward() 
</code></pre>
<p>ASM:</p>
<pre><code class="language-c">mov rcx, 0
loop_head:
cmp rcx, 18
jge loop_end
call walk_forward
jmp loop_head 
loop_end:
// any code after loop
mov rax, 0
</code></pre>
<h3 id="while-loop"><a class="header" href="#while-loop">while loop</a></h3>
<p>When you don't know how many times you want to iterate, or your stopping condition is something special, you use a while loop:</p>
<p>High-Level:</p>
<pre><code class="language-python">x = 80
y = 0
while x != 0:
    x = x - 2
    y += 1
</code></pre>
<p>ASM:</p>
<pre><code class="language-c">// rdi = x, rax = y
mov rdi, 80
mov rbx, 0

loop_head:
cmp rdi, 0
je loop_end
sub rdi, 2
add rbx, 1
jmp loop_head

loop_end:
mov rax, rbx
//any code after loop 
</code></pre>
<h2 id="conclusion-2"><a class="header" href="#conclusion-2">Conclusion</a></h2>
<p>With the general knowledge of these structures, you should be ready to start making some simple programs in x86.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hacker-practice-1"><a class="header" href="#hacker-practice-1">Hacker Practice</a></h1>
<h2 id="embryoasm"><a class="header" href="#embryoasm">EmbryoASM</a></h2>
<p>For <code>'ike</code> we developed a module to teach and test x86 with the intention of serving it to people who have never programmed before. The hacker practice for this chapter will involve you solving all the challenges on <code>EmbryoASM</code>, which will cover every subsection of Assembly in this chapter and test your knowledge of logic, memory, and how an architecture works. </p>
<p>For now, we have <code>EmbryoASM</code> deployed on <code>pwn.college</code> as the <code>Assembly Refresher</code> module. To play the levels, first register an account on <a href="https://dojo.pwn.college/register">dojo.pwn.college</a>. After that, skip all other modules and go right to <a href="https://dojo.pwn.college/fundamentals/assembly-crash-course">ASM Crash Course</a>.</p>
<h2 id="how-to-use-pwncollege"><a class="header" href="#how-to-use-pwncollege">How to use pwn.college</a></h2>
<p>To play a level, first click the <code>start</code> button. Next, you have two options:</p>
<ol>
<li>You can play in browser by now clicking the <code>Workspace</code> tab which will open a VS code instance in your browser with an embedded terminal</li>
<li>(<strong>Recommended</strong>) You can <code>ssh</code> onto the box after hitting play. It will start a Docker container ready for you to connect at <code>dojo.pwn.college</code> as user <code>hacker</code></li>
</ol>
<p>To do option <code>2</code>, you must first upload an ssh key in the <a href="https://dojo.pwn.college/settings#key">settings</a> tab of your profile. You will use this same key to ssh onto the pwn.college instance. After that you can connect like so:</p>
<pre><code class="language-bash">ssh -i /path/to/key hacker@dojo.pwn.college
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="programming-languages"><a class="header" href="#programming-languages">Programming Languages</a></h1>
<p>A chapter on how programming languages differ, using C, using Python, and preparing 
ourselves for a deeper dive into how the computer works using compiled languages.
Even if you have written C or Python before, I recommend glancing over the sections. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h1>
<p>If you are a blossoming computer scientist, it is likely you have heard about the language
<a href="https://www.python.org/about/">Python</a>. With the knowledge of a single language, you think 
realize that there must be many different languages to talk to a computer with. What may
come as something interesting is that there are distinct groups of languages we call
<a href="https://en.wikipedia.org/wiki/Programming_paradigm">programming paradigms</a>. There are 
distinct programming paradigms, but many are too difficult to understand this early in 
your coding career, so we will only focus on <a href="https://en.wikipedia.org/wiki/Imperative_programming">Imperative Programming</a>.</p>
<h2 id="imperative-programming"><a class="header" href="#imperative-programming">Imperative Programming</a></h2>
<p>Imperative programming is what many refer to as normal programming. You think in variables
like in math. A simple example is when you want to compute the speed of something. 
You are an advanced enough mammal that you can create a formula (a series of symbols) for
this idea:</p>
<pre><code>speed = distance / time
</code></pre>
<p>Now when you want to compute the speed, you simply assign values to the variables 
<code>distance</code> and <code>time</code> that you specify in the formula. These are parameters:</p>
<pre><code>compute_speed(distance, time):
    speed = distance / time 
    return speed
</code></pre>
<p>Finally, you just assign values:</p>
<pre><code>compute_speed(10, 1)
</code></pre>
<p>Which outputs <code>10</code>. This is imperative. Variables are assigned, functions return values, 
and things work in this linear fashion. All is good. If you care to know what else exists
feel free to read up on <a href="https://en.wikipedia.org/wiki/Declarative_programming">declaritive languages</a>, but
it's optional. Now let's talk about the division in imperative languages </p>
<p>Two exist:</p>
<ul>
<li>Compiled Languages</li>
<li>Interpreted Languages </li>
</ul>
<h2 id="compiled-languages"><a class="header" href="#compiled-languages">Compiled Languages</a></h2>
<p>It's likely you've also heard of the language <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C</a>.
You must be wondering, how is <code>C</code> any different from <code>Python</code>? Why is Python more popular now? Which should
I use? These are all valid questions. Let's start by showing you what <code>C</code> is, then compare it to Python later.</p>
<p><code>C</code> is a compiled language. This means the process of compilation must be done on the language after you write
it. According to <a href="https://www.computerhope.com/jargon/c/compilat.htm">ComputerHope</a>:</p>
<blockquote>
<p><strong>Compilation</strong> is the process the computer takes to convert a high-level programming language into a machine language that the computer can understand. The software which performs this conversion is called a compiler.</p>
</blockquote>
<p>In many ways, this makes sense. You can't just say English things to the computer. It needs to be translated
into something the computer understands, i.e., <code>100101011110101...</code>—binary. You may think this is stupid,
since you already need to convert your high-level ideas into a specific language, then that language gets
translated again. The only reason this current way is more efficient is that it's easier to write
<code>C</code> than it is to write <code>binary</code>. </p>
<p>This means that our code can only work (run) on a computer after it has been compiled into a program. 
Assuming we can convert our high-level idea into C-code, our workflow now looks like this:</p>
<p><img src="4_programming_languages/./c_workflow.jpeg" alt="c_workflow" /></p>
<p><code>C Code</code> -&gt; <code>&lt;compiler&gt;</code> -&gt; <code>Binary Code</code> </p>
<h3 id="diy-c"><a class="header" href="#diy-c">DIY C</a></h3>
<p>Let's quickly do a simple example, though you are not sure how to code yet. Take the written code
below and write it into a file with vim: </p>
<pre><code class="language-bash">vim example.c
</code></pre>
<p>write:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main()
{
    printf(&quot;Hello World, from C!\n&quot;);
}
</code></pre>
<p>What is the type of the file we just created? Let's take a look with the <code>file</code> command:
(don't mind the <code>▶</code> shown, that is my custom shell symbol).</p>
<pre><code class="language-bash">▶ file example.c
example.c: C source, ASCII text
</code></pre>
<p>It's an <a href="https://en.wikipedia.org/wiki/ASCII">ASCII</a> text file that the OS identified as a C source file. 
If you are not familiar with ASCII, it's a way to encode numbers as letters and vice versa. 
For example <code>65</code> translate to <code>A</code> and the other way around as well. For now, know that this is just a file
full of readable text.</p>
<p>Now lets <strong>compile</strong> it! <a href="https://gcc.gnu.org">gcc</a> is the GNU (another name for Linux) C Compiler. Let's use it:</p>
<pre><code class="language-bash">gcc example.c -o example 
</code></pre>
<p>We used <code>gcc</code> and told it to name the output as <code>example</code>. You should now see it in the same directory:</p>
<pre><code class="language-bash">▶ ls
example  example.c
</code></pre>
<p>Now what is the type of <code>example</code>? Let's check:</p>
<pre><code class="language-bash">▶ file example
example: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=aeac59bbc04b9845665af0406044181d241f31f6, not stripped
</code></pre>
<p>Wo. That is a lot of information. For now, let's talk about the first segment of text: 
<code>example: ELF 64-bit LSB shared object</code>. This means <code>example</code> is a 64-bit ELF. What is an ELF?
Not a magical creature, but an executable program! Anything that is an <code>ELF</code> is a compiled
program that is ready and in computer language. Let's run it!</p>
<pre><code class="language-bash">▶ ./example
Hello World, from C!
</code></pre>
<p>Amazing, it executed as expected.
What else is an ELF? Almost everything we use in the shell. Take for example <code>ls</code>:</p>
<pre><code class="language-bash">▶ file /bin/ls
/bin/ls: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=9567f9a28e66f4d7ec4baf31cfbf68d0410f0ae6, stripped
</code></pre>
<p>Yup it's an ELF. We will go deeper into ELF's in the <a href="4_programming_languages/../4_computer_organization/introduction.html">computer organization</a> section.
For now, know it's a compiled program. There are many compiled langauges out there. C and C++ are currently 
the most used. Here are some of the most popular:</p>
<ul>
<li><a href="https://www.w3schools.com/cpp/cpp_intro.asp">C++</a></li>
<li><a href="https://www.rust-lang.org/">Rust</a></li>
<li><a href="https://golang.org/">Go</a></li>
<li><a href="https://developer.apple.com/swift/">Swift</a></li>
</ul>
<h2 id="interpreted-languages"><a class="header" href="#interpreted-languages">Interpreted Languages</a></h2>
<p>Unlike <code>C</code>, Python is not compiled (or at least not on the surface). Python is interpreted line-by-line.
This is really nice when you are working fast, because when you compile if there is one mistake in your
code, the entire program will not compile—which means you now have nothing but a C file. In Python,
if the code never executes to that section of the code, then it does not care. In addition, you can
execute entire lines of code independently. This is what makes an interpreted language different from 
a compiled one.</p>
<p>With interpreted languages, the language is fed into an interpreter, which then executes the code.
So similarly to compiled languages, we have a middle man that does some kind of translation; except 
now it's on a line-by-line basis. Let's look at it closer, on the DIY scale.</p>
<h3 id="diy-python"><a class="header" href="#diy-python">DIY Python</a></h3>
<p>Like last time put this in a file: </p>
<pre><code class="language-bash">vim example.py
</code></pre>
<pre><code class="language-python">#!/usr/bin/env python3
print(&quot;Hello World, from Python!&quot;)
</code></pre>
<p>As you can probably tell already, Python is much more concise. This is usually true when comparing
an interpreted language to a compiled one. Now let's see what the type of this file is:</p>
<pre><code class="language-bash">▶ file example.py
example.py: Python script, ASCII text executable
</code></pre>
<p>Yup, like last time it's an ASCII file identified as Python code. Now to make this executable we need
to give it the executable permission:</p>
<pre><code class="language-bash">chmod +x example.py
</code></pre>
<p>Then we can finally execute it like we did with the earlier example:</p>
<pre><code class="language-bash">▶ ./example.py
Hello World, from Python!
</code></pre>
<p>Now, you must be wondering, how the hell did we just run a file full of readable text? 
Based on what we just learned, that should be impossible. It should have to go through some
sort of middle-man that converts the code into a machine language. Well some magic happened 
that we did not see:</p>
<pre><code class="language-python">#!/usr/bin/env python3
</code></pre>
<p>That first line we wrote told the shell to execute this file using the <code>python3</code> command. 
This is equivalent to running the program like this:</p>
<pre><code class="language-bash">▶ python3 example.py
Hello World, from Python!
</code></pre>
<p>And what the hell is <code>python3</code>? I think you know...
Note: <code>python3</code> is a symbolic link for <code>python3.6</code></p>
<pre><code>▶ file /usr/bin/python3.6
/usr/bin/python3.6: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=fc614aa299a924960da33b875fb9cfaa641ea5bc, stripped
</code></pre>
<p>Yup, it's an <code>ELF</code>. This means that the interpreter is indeed a compiled program written in 
a compiled language (C++ in this case). Things make sense again. Since we know the 
interpreter is magical; let's take this one step further. We can actually execute
the interpreter without any initial code:</p>
<pre><code class="language-bash">▶ python3
Python 3.6.9 (default, Oct  8 2020, 12:12:24)
[GCC 8.4.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;
</code></pre>
<p>Executing <code>python3</code> alone should put you in some kind of prompt now. It's ready
to execute things line by line. Try it:</p>
<pre><code class="language-python">&gt;&gt;&gt; print(&quot;hello world&quot;)
hello world
&gt;&gt;&gt; print(&quot;wow so cool&quot;)
wow so cool
&gt;&gt;&gt; print(4 + 5)
9
</code></pre>
<p>Pretty cool right? It executes things line by line and can even use variables you define.
As you can see, all interpreted languages are built on compiled languages. At the end 
of the day, the computer only understands machine language—remember this. </p>
<p>Here are some popular interpreted languages:</p>
<ul>
<li><a href="https://www.python.org/about/">Python</a></li>
<li><a href="https://www.javascript.com/">Java Script</a></li>
<li><a href="https://www.ruby-lang.org/en/">Ruby</a></li>
<li><a href="https://www.gnu.org/software/bash/manual/html_node/What-is-Bash_003f.html">Bash</a> </li>
</ul>
<p>Yes, the shell you have been using is indeed an interpreted language. </p>
<h2 id="speed-comparison"><a class="header" href="#speed-comparison">Speed Comparison</a></h2>
<p>The last thing to mention is that because of the nature of executing a program line-by-line,
compiled languages are often <strong>much</strong> faster than interpreted languages. For instance,
let's compare two programs that do the exact same thing in two languages.</p>
<p>You know the deal:</p>
<pre><code class="language-bash">vim test.c
</code></pre>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main()
{
    int temp = 0;
    for(int i = 0; i &lt; 1000000000; i++);
        temp += 1;
    return temp;
}
</code></pre>
<pre><code class="language-bash">gcc test.c -o test
</code></pre>
<p>Now let's write the python version:</p>
<pre><code class="language-bash">vim test.py
</code></pre>
<pre><code class="language-python">#!/usr/bin/env python3
def main():
    temp = 0
    for i in range(1000000000):
        temp += 1
    return temp

main()
</code></pre>
<pre><code class="language-bash">chmod +x test.py
</code></pre>
<p>Now we have two versions, <code>test.py</code> and <code>test</code> -- a compiled vs interpreted race.
Both of these programs run the action <code>&quot;increment temp&quot;</code> <strong>1 billion times</strong>.
For the C program, this is nothing, but for python... well. Let's time it:</p>
<pre><code class="language-bash">▶ time ./test
./test  2.28s user 0.00s system 99% cpu 2.285 total
</code></pre>
<p>The C program took <code>2.28</code> seconds. Let's time the Python one (wait for it!):</p>
<pre><code class="language-bash">▶ time ./test.py
./test.py  37.60s user 0.01s system 99% cpu 37.620 total
</code></pre>
<p>The python program took <code>37.60</code> seconds. Wow. Your times may be slightly different,
but the difference being large will be the same. In this case, <code>C</code> was <strong>16 times
faster</strong>. You can see how this gets bad on a larger scale, but I digress.</p>
<p>Let's move on to using these languages. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c"><a class="header" href="#c">C</a></h1>
<p>Our compiled language of choice will be <code>C</code> because it is the most fundamental
and widely used compiled language that exists. All languages build on C's
success, so we will start with it.</p>
<h2 id="learning-to-program-in-c"><a class="header" href="#learning-to-program-in-c">Learning to program in C</a></h2>
<p>This is where the handbook does less justice. It's a lengthy process to teach
someone how to program in another language, so I will defer this process to 
an external location. </p>
<p>First, I recommend reading from the <strong>beginning to page 20</strong> in the book 
<code>Hacking: The Art of Exploitation, 2nd Edition</code>. This will give you a 
high-level overview of the structures we use in programming. Next, you
will need to actually learn the general syntax of C. I am not asking you
to become a master, but you must learn the fundamentals. </p>
<p>Here are some tutorials I recommend, either will take at least a week or more to complete,
but you got this. You are a hacker now. </p>
<p>Tutorials, choose one:</p>
<ul>
<li><a href="https://www.learn-c.org/">Learn-C</a></li>
<li><a href="https://www.programiz.com/c-programming">Programiz</a></li>
</ul>
<p>Before starting on the actual tutorial, it may be helpful to read the other
three sub-sections associated with this section, i.e.:</p>
<ul>
<li><a href="4_programming_languages/./write_c.html">Writing Code</a></li>
<li><a href="4_programming_languages/./compilation.html">Compiling &amp; Running Code</a></li>
<li><a href="4_programming_languages/./debugging_c.html">Debugging Code</a></li>
</ul>
<p>They are only there to give you suggestions on good ways to write, compile, and debug
from my personal experience. These will help you write code faster while you learn, but
may not be necessary since many tutorials have you program in the browser now.</p>
<p><strong>OK</strong>, start the tutorial and move on to the Python section when you are done. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writing-code"><a class="header" href="#writing-code">Writing Code</a></h1>
<p>Considering you have done the <a href="4_programming_languages/../2_operating_systems/terminal.html">Terminal</a> section 
in the Operating Systems chapter, you already know about vim: the universal 
terminal based text editor. I stand by this notion that <code>vim</code> is the supreme editor
when it comes to it's awesome key-bindings, but vim lacks features that other
editors have made normal. For this very reason, you need to use plugins 
with vim to make it actually usable. In this section, I show you how to edit
C code faster and better.</p>
<h2 id="using-plugins-with-vim"><a class="header" href="#using-plugins-with-vim">Using plugins with Vim</a></h2>
<p>Get <code>Vundle</code> installed so we can add plugins. Go to their repo <a href="https://github.com/VundleVim/Vundle.vim#quick-start">here</a>
After you have it installed, you will have a default looking <code>.vimrc</code> that should look like this:</p>
<pre><code class="language-vim">set nocompatible              &quot; be iMproved, required
filetype off                  &quot; required

&quot; set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
&quot; alternatively, pass a path where Vundle should install plugins
&quot;call vundle#begin('~/some/path/here')

&quot; let Vundle manage Vundle, required
Plugin 'VundleVim/Vundle.vim'

&quot; The following are examples of different formats supported.
&quot; Keep Plugin commands between vundle#begin/end.
&quot; plugin on GitHub repo
Plugin 'tpope/vim-fugitive'
&quot; plugin from http://vim-scripts.org/vim/scripts.html
&quot; Plugin 'L9'
&quot; Git plugin not hosted on GitHub
Plugin 'git://git.wincent.com/command-t.git'
&quot; git repos on your local machine (i.e. when working on your own plugin)
Plugin 'file:///home/gmarik/path/to/plugin'
&quot; The sparkup vim script is in a subdirectory of this repo called vim.
&quot; Pass the path to set the runtimepath properly.
Plugin 'rstacruz/sparkup', {'rtp': 'vim/'}
&quot; Install L9 and avoid a Naming conflict if you've already installed a
&quot; different version somewhere else.
&quot; Plugin 'ascenator/L9', {'name': 'newL9'}

&quot; All of your Plugins must be added before the following line
call vundle#end()            &quot; required
filetype plugin indent on    &quot; required
&quot; To ignore plugin indent changes, instead use:
&quot;filetype plugin on
&quot;
&quot; Brief help
&quot; :PluginList       - lists configured plugins
&quot; :PluginInstall    - installs plugins; append `!` to update or just :PluginUpdate
&quot; :PluginSearch foo - searches for foo; append `!` to refresh local cache
&quot; :PluginClean      - confirms removal of unused plugins; append `!` to auto-approve removal
&quot;
&quot; see :h vundle for more details or wiki for FAQ
&quot; Put your non-Plugin stuff after this line
</code></pre>
<p>Before the line: <code>&quot; All of your Plugins must be added before the following line</code>
Add the following:</p>
<pre><code>Plugin 'valloric/youcompleteme'
Plugin 'VundleVim/Vundle.vim'
Plugin 'airblade/vim-gitgutter'
Plugin 'editorconfig/editorconfig-vim'
Plugin 'itchyny/lightline.vim'
Plugin 'junegunn/fzf'
Plugin 'junegunn/fzf.vim'
Plugin 'mattn/emmet-vim'
Plugin 'scrooloose/nerdtree'
Plugin 'scrooloose/syntastic'
Plugin 'scrooloose/nerdcommenter'
</code></pre>
<p>Yeah, it's a series of plugins that make vim usable. The only thing you need to
do in addition to this is install the <code>youcompleteme</code> things to make autocompleting
a thing. Follow their <a href="https://github.com/ycm-core/YouCompleteMe#linux-64-bit">install guide</a>.</p>
<p>After that is all in, feel free to explore what the hell you just installed ;). 
For one, you now have autocompleting, a directory view, and a nice lightline. 
Check it all out. </p>
<h2 id="using-vim-in-another-editor"><a class="header" href="#using-vim-in-another-editor">Using Vim in another Editor</a></h2>
<p>Sometimes I don't like to use the command line to do my editing of code. Maybe you feel
the same. When I don't want to use the terminal (usually for bigger or longer-lasting
projects), I use <a href="https://code.visualstudio.com/download">VS Code</a>. 
Don't worry; it is not the regular Visual Studio. This is a pretty minimal open-source editor 
that works on all platforms. Especially Linux. It's very good and I recommend using it.</p>
<p>But to make it <strong>ACTUALLY</strong> usable, it must have vim embedded in it. That's right, vim
key bindings. Go ahead and install this <a href="https://marketplace.visualstudio.com/items?itemName=vscodevim.vim">vim plugin</a>
into your VS Code once you have it installed and setup. </p>
<p>The lists of features in this editor is endless. One of my favorite features 
is that you edit files on a remote machine with ssh in VSCode. It's super seamless 
and makes it feel like you are just editing a local file. 
<a href="https://code.visualstudio.com/docs/remote/ssh">Check it out</a>.</p>
<h2 id="using-a-multiplexer-tmux"><a class="header" href="#using-a-multiplexer-tmux">Using a multiplexer (tmux)</a></h2>
<p>Lastly, you are going to want to use some sort of multiplexer when you are editing
code. It helps so you don't need to switch between tabs and such. My setup often
looks like this:</p>
<p><img src="4_programming_languages/./my_setup.png" alt="my_setup" /></p>
<p>In the left I have the source; In the right I have it split to run commands and
see in/output and also have a <code>man</code> page up for commands I don't understand. 
It makes coding in the terminal supa-hot-fire.</p>
<p>This is all made possible with <a href="https://github.com/tmux/tmux/wiki">tmux</a> a terminal
multiplexer. It's very similar to having a terminal that splits this for you. Many
people like to use Terminator for this. I recommend using tmux. It will make you a 
better hacker and is usable on SSH connections. </p>
<p>Install tmux and xclip:</p>
<pre><code class="language-bash">sudo apt-get install tmux xclip
</code></pre>
<p>Then use the config I have specially made to emulate <code>Terminator</code>:</p>
<pre><code class="language-bash">vim ~/.tmux.conf
</code></pre>
<pre><code class="language-conf"># Set tmux to split and move like Terminator
bind-key -n C-E split-window -h
bind-key -n C-O split-window -v
bind-key -n 'M-Up' select-pane -U
bind-key -n 'M-Left' select-pane -L
bind-key -n 'M-Right' select-pane -R
bind-key -n 'M-Down' select-pane -D

# Make sure the mouse is useable
set -g mouse on

# Turn the status oon
set -g status off
# statusbar
set -g status-position bottom
set -g status-justify left
set -g status-left ''
set -g status-right-length 50
set -g status-left-length 20
setw -g window-status-bell-style 'fg=colour255 bg=colour1 bold'


# Make the colors good
set -g default-terminal &quot;screen-256color&quot;

# Set copy and paste
set -g mouse on
bind -n WheelUpPane if-shell -F -t = &quot;#{mouse_any_flag}&quot; &quot;send-keys -M&quot; &quot;if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'&quot;
bind -n WheelDownPane select-pane -t= \; send-keys -M
bind -n C-WheelUpPane select-pane -t= \; copy-mode -e \; send-keys -M
bind -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-up
bind -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-down
bind -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-up
bind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down

# To copy, left click and drag to highlight text in yellow,
# once you release left click yellow text will disappear and will automatically be available in clibboard
# # Use vim keybindings in copy mode
setw -g mode-keys vi
# Update default binding of `Enter` to also use copy-pipe
unbind -T copy-mode-vi Enter
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel &quot;xclip -selection c&quot;
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel &quot;xclip -in -selection clipboard&quot;
</code></pre>
<p>Usage:</p>
<ul>
<li>Split Vertically: <code>Ctrl+Shift+e</code></li>
<li>Split Horizontally: <code>Ctrl+Shift+o</code></li>
<li>Destroy Pane: <code>Ctrl+d</code></li>
<li>Move between panes with <code>Alt+arrow_key</code>
<ul>
<li>Example: move left: <code>Alt+left_arrow_key</code></li>
</ul>
</li>
</ul>
<p>Lastly, you can now just copy things in your terminal by selecting it with your mouse.
It will automatically copy it while in a <code>tmux</code> session. If you destroy every pane,
it will exit out of the <code>tmux</code> session. Feel free to rebind everything. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compilation--execution"><a class="header" href="#compilation--execution">Compilation &amp; Execution</a></h1>
<h2 id="introduction-9"><a class="header" href="#introduction-9">Introduction</a></h2>
<p>As you know, compilation is the conversion of your high-level C code into assembly and then into machine code that the computer can understand. Lucky for you, nearly every Linux machine comes with the most popular compiler <code>gcc</code>. I did say the <em>most</em> popular compiler though, there are actually <a href="https://clang.llvm.org/">a few that people use</a>. For simplicity, we will only refer to gcc as our compiler. </p>
<p>Let's compile a simple program:</p>
<pre><code>int main()
{
    for(int i; i &lt; 10000; i++) {
        puts(&quot;hello world&quot;);
    }
}
</code></pre>
<blockquote>
<p>Recall: you can place text in a file using &quot;vim filename&quot;</p>
</blockquote>
<pre><code class="language-bash">$ cat ex.c
int main()
{
    for(int i; i &lt; 10000; i++) {
        puts(&quot;hello world&quot;);
    }
}
</code></pre>
<p>Compile it by passing its name to gcc:</p>
<pre><code>gcc ex.c
</code></pre>
<p>Now you will have a file named <code>a.out</code> in the same directory. You can execute it by running <code>./a.out</code>.</p>
<pre><code class="language-bash">$ ./a.out
hello world
hello world
hello world 
[truncated]
hello world
</code></pre>
<p>Yay you can compile and execute now! Let's talk about common compiler flags.</p>
<h2 id="common-compiler-flags"><a class="header" href="#common-compiler-flags">Common Compiler Flags</a></h2>
<h3 id="change-output-name"><a class="header" href="#change-output-name">Change output name</a></h3>
<p>First up is <code>-o</code>:</p>
<pre><code>gcc ex.c -o ex
</code></pre>
<p>This outputs a file named <code>ex</code>. Yes <code>-o</code> lets you choose the output file name.</p>
<h3 id="change-optimizations"><a class="header" href="#change-optimizations">Change optimizations</a></h3>
<p>Next is <code>-ON</code>, where <code>N</code> is some number between [1, 3]. The <code>-O</code> option lets you choose the optimization level of the code, which you should read more about <a href="https://developer.arm.com/documentation/den0013/d/Optimizing-Code-to-Run-on-ARM-Processors/Compiler-optimizations/GCC-optimization-options">from arm docs</a>. </p>
<p>Let's do a quick test. Often when you need code faster, you want to use a higher level of optimization. <code>-O3</code> is considered to be dangerous since it can more easily introduce bugs into your code, so instead we use <code>-O2</code>. Lets see the difference.</p>
<pre><code>gcc ex.c -o ex2 -O2
</code></pre>
<p>You'll notice the program takes about the same time to run as the original. This is because the code is so small and simple. If you want to see larger results, compile larger binaries like <a href="https://github.com/coreutils/coreutils">coreutils binaries</a>. Speaking of coreutils binaries, your system usually has coreutils compiled with <code>-O2</code>. As an example, <code>ls</code> is a coreutils binary compiled with <code>-O2</code>. </p>
<h3 id="change-linking"><a class="header" href="#change-linking">Change linking</a></h3>
<p>We talked about speed, but what about protability? </p>
<blockquote>
<p>Recall: in the <a href="4_programming_languages/../3_computer_organization/memory_segments.html">computer organizatio memory-segment section</a> we talked about a program being mapped into memory with multiple other programs, one such program was libc. This is because when we compiled the binary it was linked. </p>
</blockquote>
<p>When compiling a binary, gcc automatically <a href="https://medium.com/@dkwok94/the-linking-process-exposed-static-vs-dynamic-libraries-977e92139b5f">links</a> the binary, which means it maps code from other programs into it's process memory space when running. As an example run this commnad:</p>
<pre><code class="language-bash">ldd ./ex
</code></pre>
<p>This will show something like:</p>
<pre><code class="language-bash">	linux-vdso.so.1 (0x00007ffc0f3d5000)
	libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f5b46d4c000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f5b46f59000)
</code></pre>
<p>All those programs will be mapped into memory when this program runs. This makes sense, since I did not right the <code>puts</code> function shown in our code. That <code>puts</code> is from <code>libc</code> which is shown above.</p>
<p>So what happens if you give a friend this binary and they dont have libc on their system? Or, what if they don't have the same version? Well then they can't run your binary. Luckily, there is a way to include ALL the external code you use in one binary. This is called <a href="https://kb.iu.edu/d/akqn">static</a> linking. Let's try it:</p>
<pre><code class="language-bash">gcc ex.c -o ex_static -static
</code></pre>
<p>This binary runs just like the other binary, but now when we check it with ldd:</p>
<pre><code class="language-bash">$ ldd
	not a dynamic executable
</code></pre>
<p>Yup it's not dynamic, so no other programs are mapped. So what is the tradeoff? Run this command to see something:</p>
<pre><code class="language-bash">ls -lah ex*
</code></pre>
<p>You will see something like, but with your user:</p>
<pre><code class="language-bash">-rwxrwxr-x 1 parallels parallels  17K Feb  7 10:00 ex
-rwxrwxr-x 1 parallels parallels  17K Feb  7 09:48 ex2
-rw-rw-r-- 1 parallels parallels   83 Feb  7 09:57 ex.c
-rwxrwxr-x 1 parallels parallels 852K Feb  7 09:57 ex_static
</code></pre>
<p>Notice, <code>ex_static</code> is <code>852K</code>! That is 50x bigger than <code>ex</code>, for a program so small. What if this program was already big? Well then it would be even huger. This is of course because all the code of the external programs like libc are now in this program. </p>
<p>If you want, you can also prove to yourself that nothing is mapped into memory when you run the binary with the program below (read the warning below): </p>
<pre><code>while true; do ./ex_static fake_arg &amp; cat /proc/&quot;$!&quot;/maps &gt;&gt; mymaps; done
</code></pre>
<p>Warning: you will need to <code>Ctr+C</code> (kill) this after 10 seconds yourself, since it is a little hard to collect the maps of a short-lived process. The output will be in the mymaps file.</p>
<h3 id="debug-options"><a class="header" href="#debug-options">Debug options</a></h3>
<p>If you compile with the <code>-g</code> flag, you include symbols in the binary. For now, just know this means it makes it both bigger, slower, but easier to debug with a debugger. We will cove this more in <a href="4_programming_languages/./debugging_c.html">debugging-c</a>.</p>
<h3 id="developer-options"><a class="header" href="#developer-options">Developer options</a></h3>
<p>The last thing we would like to mention is that if you see a <code>-f</code> at the beginning of an option, like <code>-fno-pie</code>, that means the binary is being compiled with a special developer option. These options often do dangerous or interesting things. Like the command above <code>-fno-pie</code> turns off an important security mechanic of the program you are compiling. It can also be used if you need to remove specific optimizations from compiling. For most people, you will not need to touch this. If you see it being used for a program you are examining, recall this paragraph about wacky things happening with <code>-f</code>.</p>
<h2 id="makefiles"><a class="header" href="#makefiles">Makefiles</a></h2>
<p>We should also mention that nearly every large source base uses something called a <code>Makefile</code>, which, when used with the <code>make</code> command compiles the binary (and can do other things). You can consider a Makefile as a series of shell commands. Let's make a simple one for compiling our binary with optimization 2 and static linking:</p>
<pre><code class="language-Makefile">all:
    gcc ex.c -o ex_final -O2 -static
</code></pre>
<p>The file you put this in MUST be named <code>Makefile</code>. Now that you have make the Makefile, run it by running <code>make</code>. This will compile the binary <code>ex_final</code>. For more useage, see this <a href="https://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/">tutorial</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging"><a class="header" href="#debugging">Debugging</a></h1>
<h2 id="introduction-10"><a class="header" href="#introduction-10">Introduction</a></h2>
<p>A debugger is a tool you use to understand and run analysis on a binary. It allows you to step through instructions and view memory as it is running. Just like <code>gcc</code>, there exist a debugger called <code>gdb</code>. The <code>g</code> in all of these names stands for <a href="https://www.gnu.org/home.en.html">GNU</a>. </p>
<h2 id="debugging-programs-you-wrote"><a class="header" href="#debugging-programs-you-wrote">Debugging Programs You Wrote</a></h2>
<p>When you have the source for a program, debugging it is very easy. You compile the binary we used in the last secion again with <code>-g</code> flag which makes it have symbols and be in a ready form for <code>gdb</code>.</p>
<pre><code>gcc ex.c -o ex -g
</code></pre>
<p>Now run the binary with</p>
<pre><code>gdb ./ex
</code></pre>
<p>You will now see a bunch of text ending in:</p>
<pre><code>Reading symbols from ./ex...
(gdb)
</code></pre>
<p>You are in the <code>gdb</code> prompt now. To exit you can type <code>exit</code> and hit enter. For now we will stay and run a few commands. </p>
<p>Since symbols exist, you can just break at any line in the source you like. Breaking is the stopping of code at a certain condition. When you set a breakpoint you tell the debugger to stop the program at a certain symbol or address. Run:</p>
<pre><code>b main:1
r
</code></pre>
<p>We said <code>break at line 1 in the main function and run</code>. Type <code>l</code> and now you will see where you are:</p>
<pre><code>(gdb) l
1	int main()
2	{
3	    for(int i; i &lt; 10000; i++) {
4	        puts(&quot;hello world&quot;);
5	    }
6	}
</code></pre>
<p>Very cool. Now if we enter the command <code>n</code> (next) twice, we will be inside the loop. We can print the value of <code>i</code> at each iteration:</p>
<pre><code>(gdb) n
3	    for(int i; i &lt; 10000; i++) {
(gdb) n
4	        puts(&quot;hello world&quot;);
(gdb) p i
$1 = 0
</code></pre>
<p>We can even change the value of <code>i</code>:</p>
<pre><code>(gdb) set variable i=10000
(gdb) n
hello world
3	    for(int i; i &lt; 10000; i++) {
(gdb)
6	}
</code></pre>
<p>Now we leave the loop since we set <code>i</code>. </p>
<p>This was all possible because <code>-g</code> mapped every symbol that we see in the source to a corresponding address, stack variable, and region in the programs memory. You can find more tutorials on debugging programs you wrote <a href="https://cs.baylor.edu/~donahoo/tools/gdb/tutorial.html">here</a>. This is often where other manuals about debugging in gdb will stop... but not use. A real systems hacker needs to know how to debug programs they did not write and don't have the source too. </p>
<h2 id="debugging-programs-you-did-not-write"><a class="header" href="#debugging-programs-you-did-not-write">Debugging Programs You Did Not Write</a></h2>
<p>Let's beging by making this realistic. In the real world, programs are compiled with <code>-O2</code> and the no <code>-g</code>. Then to make matters worse, they run a speical command on the binary called <code>strip</code>. The <code>strip</code> command is like the opposite of <code>-g</code>. It removes symbols to make the binary smaller and a little faster. Importantly, it removes the names of functions. Lets compile a binary and strip it:</p>
<pre><code class="language-bash">gcc ex.c -o ex_real -O2
strip ex_real
</code></pre>
<p>Now run the program in gdb and try to break at main:</p>
<pre><code>(gdb) b main
Function &quot;main&quot; not defined.
</code></pre>
<p>Yeah... there is no symbols. So how the hell do we stop at the start of the program now? Normally this means we have to look at the entry point address of the binary and then break at that specific address then <code>s</code> (step) our way to main. Luckily, us hackers have come a long way and we have made upgrades to gdb to make debugging binaries easier. Instead of telling you to use vanilla gdb, lets use a slightly enhanced version you can run on most systems. </p>
<p>A few gdb extensions exist, but my favorite is <a href="https://github.com/hugsy/gef">GEF</a> (GDB Enhanced Features). Let's quickly install it and run this binary again.</p>
<pre><code>bash -c &quot;$(wget http://gef.blah.cat/sh -O -)&quot;
</code></pre>
<p>Now run gdb on the the binary <code>ex_real</code> again and run the command <code>entry-break</code>:</p>
<pre><code>gef➤  entry-break
Stopped due to shared library event (no libraries added or removed)
[*] PIC binary detected, retrieving text base address
[+] Breaking at entry-point: 0x5555555550a0
...
</code></pre>
<p>This will now make you screen have a bunch of info on it that you may recognize from the assembly section of this handbook. 
You should also be noticing by now that we can't see the source code anymore. You can't see the source if the symbols are not mapped in the binary, and we have no way or retrieving it. From now on, we will have to use two commands:</p>
<ul>
<li><code>si</code>: Step Instruction, steps an instruction (steps into a call)</li>
<li><code>ni</code>: Next Instruction, to step over instructions (skips stepping into a call)</li>
</ul>
<p>Now run:</p>
<pre><code>si 10
</code></pre>
<p>This will step 10 instructions. You should now see something like:</p>
<pre><code>call   QWORD PTR [rip+0x2f12]        # 0x555555557fe0
</code></pre>
<p>This call is the function <code>_libc_start_main</code>, which initializes the <code>main</code> function we know and love. It's always found in the entry of the program and it's first argument in the function address of <code>main</code>. Let's get that address and break at it.</p>
<blockquote>
<p>Recall: the first argument in System V 64 bit is <code>rdi</code></p>
</blockquote>
<pre><code>gef➤  p $rdi
$1 = 0x555555555060
gef➤  b *$rdi
Breakpoint 1 at 0x555555555060
</code></pre>
<p>Now if we use continue we go to main:</p>
<pre><code>c
</code></pre>
<p>Use <code>ni</code> until you see an instruction like</p>
<pre><code>call   0x555555555050 &lt;puts@plt&gt;
</code></pre>
<p>It's the <code>puts</code> in the loop. You should also recognize the structure of this assembly as being a loop with the <code>cmp    ebx, 0x2710</code> being right after the <code>puts</code> if you hit <code>ni</code>. Yes <code>i</code> is now the register <code>ebx</code>. Debugging a binary is much harder. But it is not impossible. We will go indepth on this concept in <a href="4_programming_languages/../5_processes/gdb.html">processes and debugging</a> section and with the <a href="https://dojo.pwn.college/challenges/gdb">EmbryoGDB</a> challenges from pwn.college. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python"><a class="header" href="#python">Python</a></h1>
<h2 id="learning-to-use-python"><a class="header" href="#learning-to-use-python">Learning to use Python</a></h2>
<p>Just like the <a href="4_programming_languages/./c.html">C</a> section, you will need to at least know the general syntax of Python. Knowing this language really helps with hacking fast.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="writing-code-1"><a class="header" href="#writing-code-1">Writing Code</a></h1>
<p>Writing code in Python is <em>very</em> similar to writing code in 
any other language, but has the subtle difference of being able
to test ideas quickly in a interactive interpreter. </p>
<p>First, go and follow everything done in the <a href="4_programming_languages/./write_c.html">Writing C</a>
section. This will get you setup with Vim and tmux. </p>
<h2 id="testing-ideas-as-you-go"><a class="header" href="#testing-ideas-as-you-go">Testing ideas as you go</a></h2>
<p>Python is very fast to write and even faster to test. For this reason
I recommend almost always writing code in the terminal using vim,
tmux, and a secret new tool called <code>IPython</code>.</p>
<p>First install it:</p>
<pre><code class="language-bash">sudo apt-get install ipython3
</code></pre>
<p>What we just installed is an upgraded interactive python interpreter.
Run it:</p>
<pre><code class="language-bash">ipython3
</code></pre>
<p>Now you are in a nice interpreter:</p>
<pre><code>▶ ipython3
Python 3.6.9 (default, Oct  8 2020, 12:12:24)
Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.

IPython 5.5.0 -- An enhanced Interactive Python.
?         -&gt; Introduction and overview of IPython's features.
%quickref -&gt; Quick reference.
help      -&gt; Python's own help system.
object?   -&gt; Details about 'object', use 'object??' for extra details.

In [1]:
</code></pre>
<p>Now you can test ideas quickly and instantly see the output. I recommend
always having this open as a pane when you are writing code. It will
allow you to test ideas very quickly and do other very interesting things.</p>
<p>Assume we have a python file called <code>my_program.py</code>, and it looks like this:</p>
<pre><code class="language-python">def reverse(lst):
    return lst[::-1]
</code></pre>
<p>Yes it's just a function. Now open up <code>ipython3</code> and do this:</p>
<pre><code class="language-python">In [1]: from my_program import reverse

In [2]: my_lst = [1,2,3,4]

In [3]: reverse(my_lst)
Out[3]: [4, 3, 2, 1]
</code></pre>
<p>Yup, we can directly execute the function inside our file. It makes for good writing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interpretation--execution"><a class="header" href="#interpretation--execution">Interpretation &amp; Execution</a></h1>
<p>This section has yet to be expanded on. For now, you can run programs with <code>python3 program_name</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-1"><a class="header" href="#debugging-1">Debugging</a></h1>
<p>This section has yet to be expanded on. For now you can do this:</p>
<p><code>import ipdb; ipdb.set_trace()</code> in your Python file wherever you want to break like when you use gdb. This will open up a <code>ipdb</code> interface that is exactly like gdb. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="processes-and-debugging"><a class="header" href="#processes-and-debugging">Processes and Debugging</a></h1>
<p>This section has yet to be completed. For now just go straight to the challenge in pwn.college.</p>
<p>First you will want to do the <a href="https://dojo.pwn.college/challenges/interaction">interaction</a> module, then go on to the <a href="https://dojo.pwn.college/challenges/gdb">debugging</a> module.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-11"><a class="header" href="#introduction-11">Introduction</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="executable-types"><a class="header" href="#executable-types">Executable Types</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-gdb"><a class="header" href="#using-gdb">Using GDB</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interacting-with-python"><a class="header" href="#interacting-with-python">Interacting with Python</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security-concepts"><a class="header" href="#security-concepts">Security Concepts</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cia"><a class="header" href="#cia">CIA</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="encryption--hashing"><a class="header" href="#encryption--hashing">Encryption &amp; Hashing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bruteforcing"><a class="header" href="#bruteforcing">Bruteforcing</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dos"><a class="header" href="#dos">DOS</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="io-vectors"><a class="header" href="#io-vectors">I/O Vectors</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="whats-next"><a class="header" href="#whats-next">What's Next</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
